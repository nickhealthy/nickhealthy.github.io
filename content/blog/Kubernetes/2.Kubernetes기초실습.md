---
title: '#2 Linux, Docker, K8Sì—ì„œ ê°ê° ë°°í¬í•´ë³´ê¸°'
date: 2021-01-11 20:07:30
category: 'ğŸ§­ Kubernetes'
thumbnail: { thumbnailSrc }
draft: false
---

## Linux í™˜ê²½ì—ì„œì˜ ë°°í¬

### ì‚¬ì „ ì¤€ë¹„ì‚¬í•­

**- node ì„¤ì¹˜**

`vi hello.js`

```javascript
var http = require('http')
var content = function(req, resp) {
  resp.end('Hello world!' + '\n')
  resp.writeHead(200)
}
var w = http.createServer(content)
w.listen(8000)
```

ë¦¬ëˆ…ìŠ¤ ì•ˆì— node jsë¥¼ ì„¤ì¹˜í•˜ê³ , ì›¹ ì„œë²„ë¥¼ ì˜¤í”ˆí•œ ë’¤ í•´ë‹¹ 8000í¬íŠ¸ë¡œ ì§„ì… ì‹œ "hello world" ë¥¼ ì¶œë ¥

## Docker í™˜ê²½ì—ì„œì˜ ë°°í¬

### ì‚¬ì „ ì¤€ë¹„ì‚¬í•­

**- docker ì—”ì§„ ì„¤ì¹˜**  
**- nodeëŠ” ì„¤ì¹˜ê°€ ì•ˆëœ ìƒíƒœ**

`vi hello.js` íŒŒì¼ ìƒì„±

```javascript
var http = require('http')
var content = function(req, resp) {
  resp.end('Hello world!' + '\n')
  resp.writeHead(200)
}
var w = http.createServer(content)
w.listen(8000)
```

`Dockerfile` íŒŒì¼ ìƒì„±

```Dockerfile
FROM node.slim # node ì´ë¯¸ì§€ë¥¼ ê°€ì ¸ì™€ì„œ nodeê°€ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” í™˜ê²½ë¥¼ êµ¬ì¶•
EXPOSE 8000 # 8000ë²ˆ í¬íŠ¸ë¥¼ ê°œë°©
COPY hello.js . # í˜„ì¬ í´ë” ì•ˆì— ìˆëŠ” hello.js íŒŒì¼ì„ í˜„ì¬ ì»¨í…Œì´ë„ˆì˜ ë””ë ‰í† ë¦¬(.)ì— ë³µì‚¬
CMD node hello.js # ì»¨í…Œì´ë„ˆê°€ ìƒì„±ëœ í›„ ëª…ë ¹ì–´ ì‹¤í–‰
```

`SHELL` ëª…ë ¹ì–´ ì‹¤í–‰

```bash
$ docker build -t {name}:{tag} .
# Dockerfileë¥¼ ì´ë¯¸ì§€í™” ì‹œí‚´
# -t ì˜µì…˜ì€ name:tag ìˆœìœ¼ë¡œ formatting í•´ì¤Œ
# ë²„ì „ì€ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ìë™ìœ¼ë¡œ latestìœ¼ë¡œ ì„¤ì •
# . ì€ Dockerfileì˜ ì´ë¦„ì„ ëª…ì‹œí•´ ì£¼ì—ˆì„ ë•Œ ìë™ìœ¼ë¡œ ì´ë¥¼ ì¸ì‹í•¨ / íŒŒì¼ì´ë¦„ì„ ë°”ê¾¸ì—ˆë‹¤ë©´ í•´ë‹¹ íŒŒì¼ì´ë¦„ì„ ê¸°ì…
```

```bash
# ì´ë¯¸ì§€ í™•ì¸
$ docker images
```

```bash
# ì´ë¯¸ì§€ë¥¼ ì‹¤í–‰
$ docker run -d -p 8100:8000 ì´ë¯¸ì§€ëª… ë˜ëŠ” ì´ë¯¸ì§€ID
# -d ë°±ê·¸ë¼ìš´ë“œë¡œ ì‹¤í–‰
# -p {ê°œë°©í•  í¬íŠ¸}:{íƒ€ì¼“ í¬íŠ¸}
```

ì´ì „ê³¼ ë˜‘ê°™ì´ js íŒŒì¼ì„ ë§Œë“¤ì–´ ì£¼ê³ ,  
nodeê°€ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•Šì€ í™˜ê²½ì—ì„œ `Dockerfile`ë¥¼ ì´ìš©í•´ `Docker hub`ì—ì„œ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë°›ì•„ nodeë¥¼ ì„¤ì¹˜í•˜ê³  ì‹¤í–‰  
8100í¬íŠ¸ë¡œ ì§„ì… ì‹œ "hello world" ë¥¼ ì¶œë ¥

<br />

ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì— `COPY`ëœ ë‚´ìš© í™•ì¸

`SHELL` ëª…ë ¹ì–´ ì‹¤í–‰

```bash
$ docker exec -it ì´ë¯¸ì§€ or ì´ë¯¸ì§€ID bin/bash
# ì»¨í…Œì´ë„ˆ ë‚´ë¶€ë¡œ ì§„ì… í›„
# ls ëª…ë ¹ì–´ë¥¼ ì³¤ì„ ë•Œ hello.js ê°€ ìƒì„±ë˜ì–´ ìˆëŠ” ê²ƒì„ í™•ì¸
```

ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ `Docker hub`ì— ë°°í¬

```bash
$ docker login
$ docker push ì´ë¯¸ì§€ëª…
```

## ì¿ ë²„ë„¤í‹°ìŠ¤ í™˜ê²½ì—ì„œì˜ ë°°í¬

Pod ìƒì„±

```yml
apiVersion: v1 # ë²„ì „
kind: Pod # ë¦¬ì†ŒìŠ¤ íƒ€ì…
metadata:
  name: hello-pod # íŒŒë“œì˜ ì´ë¦„
  labels:
    app: hello # íŒŒë“œì˜ ë ˆì´ë¸”
spec:
  containers:
    - name: hello-container # ì»¨í…Œì´ë„ˆ ì´ë¦„
      image: image_name # ë„ì»¤ í—ˆë¸Œì— ì˜¬ë¦° ì´ë¯¸ì§€ ì´ë¦„
      ports:
        - containerPort: 8000 # ì»¨í…Œì´ë„ˆ 8000ë²ˆ í¬íŠ¸ ì‚¬ìš©
```

Service ìƒì„±

```yml
apiVersion: v1
kind: Service
metadata:
  name: hello-svc
spec:
  selector:
    app: hello # ìœ„ì—ì„œ ìƒì„±í•œ Podì˜ ë ˆì´ë¸”ì´ë‘ ë§¤ì¹­
  ports:
    - port: 8200 # ì„œë¹„ìŠ¤ë¡œ ê°œë°©í•  í¬íŠ¸
      targetPort: 8000 # ì»¨í…Œì´ë„ˆì˜ í¬íŠ¸
  externalIPs:
    - 192.168.0.30 # ì™¸ë¶€ IP ì„¤ì •
```

ì¿ ë²„ë„¤í‹°ìŠ¤ì™€ ë„ì»¤ ì´ë¯¸ì§€ íŒŒì¼ë¡œ nodeì™€ ì†ŒìŠ¤ì½”ë“œ ë“± ì‰½ê²Œ pullí•´ì™€ ì„œë¹„ìŠ¤ ë°°í¬ë¥¼ ì‰½ê²Œ í•  ìˆ˜ ìˆì—ˆë‹¤.  
8100í¬íŠ¸ë¡œ ì§„ì… ì‹œ "hello world" ë¥¼ ì¶œë ¥

<br />
<a href='#'><small class='up-button'>ìœ„ë¡œ ì˜¬ë¼ê°€ê¸°ğŸ’¨</small></a>
<br />
