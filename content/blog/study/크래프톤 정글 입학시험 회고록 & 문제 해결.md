---
title: 'í¬ë˜í”„í†¤ ì •ê¸€ ì…í•™ì‹œí—˜ íšŒê³ ë¡ & ë¬¸ì œ í•´ê²°'
date: 2022-09-19 18:04:00
category: 'ğŸ“š study'
draft: false
---





ì§€ë‚œ 7ì›” ì¤‘ìˆœ, 1ë…„ 2ê°œì›” ë™ì•ˆ ì¬ì§í•˜ë˜ ITíšŒì‚¬ë¥¼ ìµœê·¼ì— ë‚˜ì˜¤ê²Œ ë˜ì—ˆë‹¤. 29ì‚´ì´ë¼ëŠ” ë‚˜ì´ì— ë§ì€ ê³ ë¯¼ì„ í•œ ëì— ê²°ì •í–ˆì§€ë§Œ, ê·¸ë˜ë„ ë‚´ ì¸ìƒ, ë‚˜ë§Œì˜ ëª©í‘œë¥¼ ìœ„í•´ì„œëŠ” ë‚˜ì˜¤ëŠ”ê²Œ ë§ë‹¤ê³  ìƒê°ë˜ì–´ ê²°ì •í•˜ê²Œ ë˜ì—ˆë‹¤.



íšŒì‚¬ë¥¼ ê·¸ë§Œë‘ê²Œ ëœ ì´ìœ ëŠ” ì—¬ëŸ¬ ê°€ì§€ ì´ìœ ê°€ ìˆì§€ë§Œ ê°€ì¥ ì•„ì‰¬ì› ë˜ ì ì€ ë‚´ê°€ ìƒê°í•œ 'ê°œë°œì'ë¼ëŠ” ì§ì—…ì˜ ë²”ìœ„ë¥¼ ë²—ì–´ë‚¬ê¸° ë•Œë¬¸ì´ë‹¤. ë¬¼ë¡  íšŒì‚¬ì˜ ê²½ì˜ ì‚¬ì •ë„ ì˜ ì•Œê³  ìˆê³ , ì„¤ë µí•œì§€ 2ë…„ë„ ì±„ ì•ˆëœ ìŠ¤íƒ€íŠ¸ì—…ì´ì—ˆê¸° ë•Œë¬¸ì— 'ìƒì¡´'ì´ ê°€ì¥ ìµœìš°ì„  ë˜ì–´ì•¼ í•œë‹¤. ì¬ì§ ì¤‘ì—ë„ "ì‹œê°„ì´ ì§€ë‚˜ë©´ ìƒí™©ì´ ë‚˜ì•„ì§€ê² ì§€, ë‹¬ë¼ì§€ê² ì§€"ë¼ê³  ë˜ë‡Œì´ë©° ì—´ì‹¬íˆ íšŒì‚¬ê°€ ì„±ì¥í•  ìˆ˜ ìˆë„ë¡ ì£¼ì–´ì§„ ì¼ì— ì§‘ì¤‘í–ˆë‹¤. í•˜ì§€ë§Œ ìŠ¤íƒ€íŠ¸ì—…ì—ì„œ 'ë‚´ê°€ í•  ìˆ˜ ìˆëŠ” ì—…ë¬´ì˜ ë²”ìœ„ê°€ ë„“ê³ , ë‹¤ì–‘í•œ ì‹œë„ë¥¼ í•´ ë³¼ ìˆ˜ ìˆì„ ê²ƒ'ì´ë¼ëŠ” ì²« ê¸°ëŒ€ì™€ ë‹¬ë¦¬ ì‚¬ì—…ì˜ íŠ¹ì„±ìƒ ì œì•½ì ì¸ ì‚¬í•­ë“¤ì´ ë§ì•˜ê³ , ì´ëŒ€ë¡œ ì‹œê°„ì´ ì§€ë‚˜ê°€ê²Œ ëœë‹¤ë©´ ê¿ˆê¿”ì˜¤ë˜ ê°œë°œìë¼ëŠ” ì»¤ë¦¬ì–´ì— ë„ë‹¬í•˜ì§€ ëª»í•  ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì„ í•˜ê²Œ ë˜ì—ˆë‹¤. ê°œë°œìê°€ ë˜ê¸° ìœ„í•´ì„œ í˜ë“¤ë”ë¼ë„ ë‹¤ì‹œ ë‚˜ì™€ ì·¨ì—… ì¤€ë¹„ë¥¼ í•˜ëŠ”ê²Œ ë§ë‹¤ê³  ìƒê°í–ˆë‹¤.



íšŒì‚¬ë¥¼ ê·¸ë§Œë‘ê¸° ì „ì— ì·¨ì—… ì¤€ë¹„ë¥¼ ë‹¤ì‹œ í•˜ê²Œ ëœë‹¤ë©´ í˜¼ìì„œ ì¤€ë¹„í•˜ê¸° ë³´ë‹¨ ê°™ì€ ëª©í‘œë¥¼ ìœ„í•´ ëª¨ì¸ ì‚¬ëŒë“¤ê³¼ ë‹¤ ê°™ì´ ìœ¼ìŒ°ìœ¼ìŒ°! í•˜ë©´ì„œ ì¤€ë¹„í•˜ë©´ í˜ë„ ë‚˜ê³  ì˜¤ë«ë™ì•ˆ ì—´ì •ì„ ê°€ì§„ ì±„ ì¤€ë¹„ë¥¼ í•  ìˆ˜ ìˆì„ ê²ƒì´ë¼ê³  ìƒê°í–ˆë‹¤. í•˜ì§€ë§Œ ì´ë¯¸ ë‚˜ëŠ” êµ­ë¹„ì§€ì›êµìœ¡ì„ ìˆ˜ê°•í•œ ì´ë ¥ì´ ìˆì—ˆë‹¤. ê·¸ëŸ¼ í˜¼ìì„œ ì·¨ì—… ì¤€ë¹„ë¥¼ í•´ì•¼í•˜ë‚˜ ì‹¶ì—ˆëŠ”ë°... ê·¸ë•Œ!! í¬ë˜í”„í†¤ ì •ê¸€ í”„ë¡œê·¸ë¨ì„ ì°¾ì„ ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤. 



í¬ë˜í”„í†¤ ì •ê¸€ í”„ë¡œê·¸ë¨ì„ ê¼¼ê¼¼í•˜ê²Œ ì•Œì•„ë³´ì•˜ëŠ”ë°, ìš°ì„  **'ì¢‹ì€ ê°œë°œì'ê°€ ë˜ê¸° ìœ„í•´ ìê¸°ì£¼ë„ì  í•™ìŠµê³¼ SWì—ë§Œ ëª°ì…í•  ìˆ˜ ìˆëŠ” ì¸ì¬ë“¤ì„ ëª¨ì§‘í•œë‹¤ëŠ”ê²Œ ê°€ì¥ ëŒë ¸ë‹¤.** ì´ì „ì—ë„ êµ­ë¹„ì§€ì›êµìœ¡ì„ ìˆ˜ê°•í•˜ë©´ì„œ ë™ë£Œë“¤í•œí…Œ 'ì—´ì •'ì´ë¼ëŠ” ë‹¨ì–´ë¥¼ ë§ì´ ë“¤ì—ˆëŠ”ë°, ì—´ì • ë„˜ì¹˜ëŠ” ì‚¬ëŒë“¤ ê³ì—ì„œ ë‚˜ë„ ì¢‹ì€ ì—ë„ˆì§€ë¥¼ ë°›ì•„ê°€ê³  ê°™ì´ ì—´ì •ì„ ë¶ˆíƒœìš°ë©´ ì‹œë„ˆì§€ íš¨ê³¼ê°€ ì—„ì²­ë‚  ê²ƒì´ë¼ê³  ìƒê°í–ˆê¸° ë•Œë¬¸ì´ë‹¤.



ì…í•™ ì„œë¥˜ë¥¼ ì§€ì›í•˜ê³  2ì£¼ê°„ ê³µë¶€í•  ìˆ˜ ìˆëŠ” ì…í•™ ì‹œí—˜ ì¤€ë¹„ìë£Œë¥¼ ì¤€ë‹¤. 2ì£¼ê°„ì˜ ëª°ì…ë„ ë†’ì€ ìŠ¤ìŠ¤ë¡œì˜ í•™ìŠµì„ í†µí•´ í¬ë˜í”„í†¤ ì •ê¸€ í”„ë¡œê·¸ë¨ì— ì í•©í•œì§€ ìŠ¤ìŠ¤ë¡œ ì ê²€í•´ ë³´ëŠ” ê²ƒì´ë‹¤. ì´ëŸ° ë¶€ë¶„ë„ ì·¨ì§€ê°€ ë„ˆë¬´ ì¢‹ë‹¤ê³  ìƒê°í•œë‹¤. ì •ë§ ì‚¬ëŒì€ ë§ˆìŒê°€ì§ì— ë”°ë¼ í–‰ë™í•œë‹¤ê³  ìƒê°í•˜ëŠ”ë°, ì´ëŸ° ì ê²€ ê³¼ì •ì„ í†µí•´ ë‚˜ ìŠ¤ìŠ¤ë¡œë¥¼ ì²´í¬í•´ ë³¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. ì‹œí—˜ì€ 7ì‹œê°„ë™ì•ˆ ì§„í–‰í•˜ì˜€ê³ , ê²°ê³¼ëŠ” ì•„ì‰½ê²Œ í•˜ë‚˜ì˜ ê¸°ëŠ¥ì„ ë§ˆì € êµ¬í˜„í•˜ì§€ ëª»í–ˆë‹¤. ê¸°ëŠ¥ì„ ëª¨ë‘ êµ¬í˜„í•˜ì§€ ëª»í–ˆë‹¤ëŠ” ê²ƒì´ ì •ë§ ì•„ì‰¬ì› ì§€ë§Œ 2ì£¼ê°„ì˜ ìŠ¤ìŠ¤ë¡œ ëª°ì…ë„ ë†’ì€ í•™ìŠµì„ í†µí•´ **'ë‚˜ ìŠ¤ìŠ¤ë¡œ ë…¸ë ¥í•˜ëŠ” ê²ƒì— ë”°ë¼ ë‹¨ê¸°ê°„ì— ì–¼ë§ˆë‚˜ ë¹ ë¥´ê²Œ ì„±ì¥í•  ìˆ˜ ìˆëŠ”ì§€, í¬ë§ì„ ë³´ì•˜ë˜ ì•„ì£¼ ì¢‹ì€ ê²½í—˜'** ì´ì—ˆë‹¤ê³  ìƒê°í•œë‹¤. (ì‹œí—˜ì´ ì¢…ë£Œëœ ì´í›„ ì£¼ë§ë™ì•ˆ ì‹œê°„ì„ íˆ¬ìí•´ ë¬¸ì œë¥¼ ëª¨ë‘ í•´ê²°í•˜ì˜€ë‹¤.)



ê¼­ ì´ í”„ë¡œê·¸ë¨ì„ ìœ„í•´ì„œê°€ ì•„ë‹ˆë¼, ì•ìœ¼ë¡œ ì¸ìƒì„ ì‚´ì•„ê°€ëŠ”ë°ë„ ë‚˜ ìŠ¤ìŠ¤ë¡œ ì¸ìƒì„ ê°œì²™í•´ ë‚˜ê°ˆ ìˆ˜ ìˆë„ë¡ ì´ ê²½í—˜ê³¼ ë§ˆìŒê°€ì§ì„ ê¸°ì–µí•˜ê³  ì•ìœ¼ë¡œ ë‚˜ì•„ê°€ì•¼ê² ë‹¤. 



<u>ì•„ë˜ëŠ” ì •ê¸€ ì‹œí—˜ ë‚´ìš©ì„ ê¸°ì–µí•˜ê¸° ìœ„í•´ ì •ë¦¬í•´ ë³¸ ë‚´ìš©ì…ë‹ˆë‹¤. ë¬¸ì œê°€ ë  ì‹œ ì‚­ì œí•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</u>

## í”„ë¡œì íŠ¸ ì„¤ê³„


### 1. í¬ìŠ¤íŒ… ì¡°íšŒ(GET)

* **ìš”ì²­ ì •ë³´**
  * ìš”ì²­ URL = `/api/list`, ìš”ì²­ ë°©ì‹ = `GET`
  * ìš”ì²­ ë°ì´í„°: ì—†ìŒ
* **ì„œë²„ê°€ ì œê³µí•  ê¸°ëŠ¥**
* DBì— ì €ì¥ë˜ì–´ ìˆëŠ” ëª¨ë“ (ì œëª©, ë‚´ìš©, ì¢‹ì•„ìš” ê°¯ìˆ˜) ì •ë³´ ë³´ë‚´ì£¼ê¸°
  * DB ë°ì´í„°ë¥¼ ë³´ë‚´ì¤„ ë•Œ ì¢‹ì•„ìš” ê°¯ìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
* **ì‘ë‹µ ë°ì´í„°**
* í¬ìŠ¤íŒ… ì •ë³´(ì œëª©, ë‚´ìš©, ì¢‹ì•„ìš” ê°¯ìˆ˜)
  * (JSON í˜•ì‹) 'result' == 'success', 'posting' í¬ìŠ¤íŒ… ì •ë³´

### 2. í¬ìŠ¤íŒ… ë§Œë“¤ê¸°(CREATE)

* **ìš”ì²­ ì •ë³´**
  * ìš”ì²­ URL = `/api/post`, ìš”ì²­ ë°©ì‹ = `POST`
  * ìš”ì²­ ë°ì´í„°: ì œëª©(title_give), ë‚´ìš©(contents_give)
* **ì„œë²„ê°€ ì œê³µí•  ê¸°ëŠ¥**
* í¬ìŠ¤íŒ… ì •ë³´ë¥¼ ëª¨ë‘ DBì— ì €ì¥(ì œëª©, ë‚´ìš©, ì¢‹ì•„ìš” ê°¯ìˆ˜ - default:0)
* **ì‘ë‹µ ë°ì´í„°**
  * APIê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ëŠ”ì§€ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì•Œë ¤ì£¼ê¸° ìœ„í•´ì„œ ì„±ê³µ ë©”ì‹œì§€ ë³´ë‚´ê¸°
  * (JSON í˜•ì‹) 'result' = 'success'
  * ì„±ê³µ ì‹œ í˜ì´ì§€ reload

### 3. í¬ìŠ¤íŒ… ìˆ˜ì •í•˜ê¸° (UPDATE)

* **ìš”ì²­ ì •ë³´**
  * ìš”ì²­ URL = `/api/update`, ìš”ì²­ ë°©ì‹ = `POST`
  * ìš”ì²­ ë°ì´í„°: DB ê°ì²´ id ê°’(id_give), ì—…ë°ì´íŠ¸ ì œëª©(new_title_give), ì—…ë°ì´íŠ¸ ë‚´ìš©(new_contents_give)
* **ì„œë²„ê°€ ì œê³µí•  ê¸°ëŠ¥**
  * í•´ë‹¹ í¬ìŠ¤íŒ… DB ê°ì²´ id ê°’(id_give)ë¥¼ ì°¾ì•„ UPDATE(new_title_give, new_contents_give)
* **ì‘ë‹µ ë°ì´í„°**
* (JSON í˜•ì‹) 'result' = 'success'
  * ì„±ê³µ ì‹œ í˜ì´ì§€ reload

### 4. í¬ìŠ¤íŒ… ì‚­ì œí•˜ê¸°(DELETE)

 - **ìš”ì²­ ì •ë³´**
    - ìš”ì²­ URL = `/api/delete`, ìš”ì²­ ë°©ì‹ = `POST`
    - ìš”ì²­ ë°ì´í„°: DB ê°ì²´ id ê°’(id_give)
- **ì„œë²„ê°€ ì œê³µí•  ê¸°ëŠ¥**
  - í•´ë‹¹ í¬ìŠ¤íŒ… DB ê°ì²´ id ê°’(id_give)ë¥¼ ì°¾ì•„ DBì—ì„œ í•´ë‹¹ ë°ì´í„°ë¥¼ ì‚­ì œ
- **ì‘ë‹µ ë°ì´í„°**
  - APIê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ëŠ”ì§€ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì•Œë ¤ì£¼ê¸° ìœ„í•´ì„œ ì„±ê³µ ë©”ì‹œì§€ ë³´ë‚´ê¸°
  - (JSON í˜•ì‹) 'result' = 'success'
  - ì„±ê³µ ì‹œ í˜ì´ì§€ reload
### 5. ì¢‹ì•„ìš” ê¸°ëŠ¥(UPDATE)

 - **ìš”ì²­ ì •ë³´**
    - ìš”ì²­ URL = `/api/like`, ìš”ì²­ ë°©ì‹ = `POST`
    - ìš”ì²­ ë°ì´í„°: DB ê°ì²´ id ê°’(id_give)
- **ì„œë²„ê°€ ì œê³µí•  ê¸°ëŠ¥**
  - í•´ë‹¹ í¬ìŠ¤íŒ… DB ê°ì²´ id ê°’(id_give)ë¥¼ ì°¾ì•„ ê¸°ì¡´ ì¢‹ì•„ìš” ê°¯ìˆ˜ì— like + 1ë¥¼ ì¶”ê°€ í›„ DB ì—…ë°ì´íŠ¸
- **ì‘ë‹µ ë°ì´í„°**
  - APIê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ëŠ”ì§€ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì•Œë ¤ì£¼ê¸° ìœ„í•´ì„œ ì„±ê³µ ë©”ì‹œì§€ ë³´ë‚´ê¸°
  - (JSON í˜•ì‹) 'result' = 'success'
  - ì„±ê³µ ì‹œ í˜ì´ì§€ reload



## êµ¬í˜„í•˜ë©´ì„œ ê²ªì€ ë¬¸ì œ í•´ê²°

### ê°ê°ì˜ í¬ìŠ¤íŒ… ì •ë³´ë¥¼ êµ¬ë³„í•˜ê¸° ìœ„í•œ ë°ì´í„° ì²˜ë¦¬

í¬ìŠ¤íŒ… CRUD API ì‘ì„± ì¤‘ ê°ê°ì˜ í¬ìŠ¤íŒ…ì´ ì–´ë–¤ê±´ì§€ ì•Œì•„ë‚´ê¸° ìœ„í•´ì„œ MongoDBì˜ `_id` ê°’ì´ í•„ìš”í–ˆìŠµë‹ˆë‹¤.(RDBì˜ Primary Key ê°™ì€ ìœ ì¼í•œ ê°’ê³¼ ë¹„ìŠ·í•œ ê°œë…ì…ë‹ˆë‹¤.) ì²˜ìŒ êµ¬í˜„í–ˆì„ ë• ìˆ˜ì •ë˜ì–´ì•¼ í•  í¬ìŠ¤íŒ…ì˜ ì œëª©ì„ ê°€ì§€ê³  ì„œë²„ì— ì œëª© ë°ì´í„°(title_give)ë¥¼ ë³´ë‚´ ê·¸ ê°ì²´ë¥¼ ì—…ë°ì´íŠ¸ í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í•˜ì˜€ìœ¼ë‚˜, ì´ë ‡ê²Œ í•˜ë©´ ì œëª©ì´ ê°™ì€ í¬ìŠ¤íŒ…ë“¤ì€ `pymongo - find_one()` í•¨ìˆ˜ë¡œ í˜¸ì¶œ ì‹œ(ì¡°ê±´ì— ë§ëŠ” ì²« ë²ˆì§¸ ë°ì´í„°ë¥¼ ì°¾ìŒ) ì—‰ëš±í•œ ê°ì²´ë¥¼ ì°¾ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ DB ë°ì´í„°ì—ì„œ ìœ ì¼í•œ ê°’ì¸ `_id`ë¥¼ ë„˜ê²¨ì£¼ê¸°ë¡œ í•˜ì˜€ìŠµë‹ˆë‹¤.

<div class="quote-block">
<div class="quote-block__emoji">ğŸ’¡</div>
<div class="quote-block__content" markdown=1>


`BSON` ë€?


 Binary JSONì˜ ì•½ì–´ë¡œ **Binaryë¡œ ì¸ì½”ë”© ëœ JSON**ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

</div>
</div>

#### JSON TypeError(MongoDBì˜ `_id` ê°’) ë¬¸ì œ

* MongoDBì˜ `_id`ë¥¼ ë„˜ê¸°ê¸° ìœ„í•´ì„œ ì²˜ìŒì—ëŠ” `list(db.collections.find())`ì´ëŸ°ì‹ìœ¼ë¡œ ì‘ì„±í•˜ì˜€ìœ¼ë‚˜ JSON í˜•íƒœë¡œ ë°ì´í„°ë¥¼ ë³´ë‚´ì£¼ê¸° ìœ„í•œ flask í•¨ìˆ˜ì¸ `jsonify`ë¥¼ ì‚¬ìš©í•  ì‹œ TypeErrorê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.(TypeError: Object of type ObjectId is not JSON serializable) ObjectId ìœ í˜•ì˜ ê°ì²´ëŠ” ì§ë ¬í™”ê°€ ë¶ˆê°€ëŠ¥í•˜ë‹¤ëŠ” ë©”ì‹œì§€ì…ë‹ˆë‹¤. **MongoDBì—ì„œ documentê°€ BSON í˜•íƒœë¡œ ì €ì¥ë˜ê³  ìˆê¸° ë•Œë¬¸ì— JSON í˜•íƒœë¡œ ë³€í™˜ì´ ë¶ˆê°€ëŠ¥í•œ ê²ƒì…ë‹ˆë‹¤.**



#### ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´!

1. python - `from bson.json_util import dumps` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ JSON(str) í˜•íƒœë¡œ ë³€ê²½
2. ìœ„ì˜ ìƒíƒœë§Œ ì§„í–‰í–ˆì„ ë•Œ, Dictionary í˜•íƒœê°€ ì•„ë‹Œ String í˜•íƒœì´ê¸° ë•Œë¬¸ì—
3. javasciprt - `JSON.parse()`ë¥¼ ì´ìš©í•´ JSON í˜•íƒœì˜ ë°ì´í„°ë¥¼ Dictionary í˜•íƒœë¡œ ë³€ê²½í•´ í•„ìš”í•œ í´ë¼ì´ì–¸íŠ¸ ë¶€ë¶„ì— ì½”ë”© ì§„í–‰
4. ë˜í•œ ì„œë²„ì¸¡ì—ì„œ pymongo ëª¨ë“ˆì„ í†µí•´ DBì˜ `_id` ê°’ìœ¼ë¡œ ì¡°íšŒ, ì‚­ì œ, ì—…ë°ì´íŠ¸ ë“±ì„ í•  ë•Œ `from bson.objectid import ObjectId` í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ `_id` ê°’ì„ ë°˜í™˜ ë°›ì•„ì•¼ ì •ìƒì ìœ¼ë¡œ ê°œì²´ì˜ 16ì§„ìˆ˜ ë¬¸ìì—´ í‘œí˜„ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
5. ì•„ë˜ *app.py* ì˜ ì‚¬ìš© ì˜ˆì‹œë¥¼ ë³´ì—¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

##### í¬ìŠ¤íŒ… ì¡°íšŒ API

```python
from bson.json_util import dumps
from bson.objectid import ObjectId

...

@app.route('/api/list', methods=['GET'])
def get_articel():
    # 1. ëª¨ë“  document ì°¾ê¸°
    result = list(db.memos.find().sort('like', -1))
    return jsonify({'result': 'success', 'posting': dumps(result)})
```

##### í¬ìŠ¤íŒ… ìˆ˜ì • API

```python
from bson.json_util import dumps
from bson.objectid import ObjectId

...

@app.route('/api/update', methods=['POST'])
def update_article():
    id_receive = request.form['id']
    update_title_receive = request.form['new_title_give']
    update_contents_receive = request.form['new_contents_give']
    db.memos.update_one({'_id': ObjectId(id_receive)},
                        {'$set': {'title_receive': update_title_receive, 'contents_receive': update_contents_receive}})
    return jsonify({'result': 'success'})
```

##### í¬ìŠ¤íŒ… ì‚­ì œ API

```python
from bson.json_util import dumps
from bson.objectid import ObjectId

...

@app.route('/api/delete', methods=['POST'])
def delete_article():
    # 1. í´ë¼ì´ì–¸íŠ¸ê°€ ì „ë‹¬í•œ id_give id_receive ë³€ìˆ˜ì— ë„£ìŠµë‹ˆë‹¤.
    id_receive = request.form['id_give']
    # 2. id_receiveì™€ ì¼ì¹˜í•˜ëŠ” idë¥¼ ì œê±°í•©ë‹ˆë‹¤.
    db.memos.delete_one({'_id': ObjectId(id_receive)})
    # 3. ì„±ê³µí•˜ë©´ success ë©”ì‹œì§€ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
    return jsonify({'result': 'success'})
```

### í† ê¸€ ë²„íŠ¼ í´ë¦­ ì‹œ, Element id ê°’ ì§€ì •

ê° í¬ìŠ¤íŒ… ë°•ìŠ¤ ë§ˆë‹¤ 'ìˆ˜ì • 'ë²„íŠ¼ í´ë¦­ ì‹œ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ êµ¬í˜„í•œ í† ê¸€ í•¨ìˆ˜ê°€ ì‘ë™í•´ì•¼ í•˜ëŠ”ë°, ì²« ë²ˆì§¸ì˜ ë°•ìŠ¤ë§Œ ì‘ë™í•˜ëŠ” ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ê°œë°œì ë„êµ¬ì™€ ì½˜ì†”ì„ ì´ìš©í•´ ì›ì¸ì„ ë¶„ì„í•œ ê²°ê³¼ **í•œ í˜ì´ì§€ ë‚´ì—ì„œì„  Elementì˜ IDê°€ ê³ ìœ í•´ì•¼ í•˜ëŠ”ë°** DOM ê°ì²´ ëª¨ë‘ê°€ ê°™ì€ IDê°’ì„ ê°€ì§€ê³  ìˆì—ˆê³ , ì˜¤íƒ€ë¡œ ì íŒ ë¶€ë¶„ì´ ìˆì—ˆìŠµë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ê° DOM ê°ì²´ë§ˆë‹¤ ë‹¤ë¥¸ ID ê°’ì„ ë¶€ì—¬í•´ ì£¼ì—ˆê³ , ì½˜ì†”ì„ í†µí•´ DOM ê°ì²´ê°€ ì„ íƒë˜ëŠ”ì§€ í™•ì¸ í›„ ì„ íƒë˜ì§€ ì•ŠëŠ”ê±¸ í™•ì¸í•˜ê³  ì˜¤íƒ€ë¥¼ ì°¾ì•„ í•´ê²°í•˜ì˜€ìŠµë‹ˆë‹¤.



#### ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´!

ë¬¸ì œ ì ‘ê·¼ ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ìµœëŒ€í•œ ë¬¸ì œë¥¼ ì˜ê²Œ ìª¼ê°œì„œ í•´ê²°í•˜ì˜€ìŠµë‹ˆë‹¤.

1. ê° DOM ê°ì²´ë§ˆë‹¤ ë°ì´í„°(index)ê°€ ë„˜ì–´ì˜¤ëŠ”ì§€ í™•ì¸
2. ì½˜ì†”ì„ ì´ìš©í•´ ê° DOM ê°ì²´ê°€ ì„ íƒë˜ëŠ”ì§€ í™•ì¸
3. ì½˜ì†”ì„ ì´ìš©í•´ DOMì˜ ì†ì„±ì— ì ‘ê·¼í•´ë³´ê¸°
   * `$("#TEST").css('display')`

```javascript
        // 'ìˆ˜ì • ë²„íŠ¼ í´ë¦­ ì‹œ í† í´'
function cardToggle(index) {
    let status = $(`#toggle-origin${index}`).css('display');

    if (status == 'block') {
        $(`#toggle-new${index}`).css('display', 'block');
        $(`#toggle-origin${index}`).css('display', 'none');
        $(`#update-title${index}`).attr('value', $(`#id-title${index}`).text());
    } else {
        $(`#toggle-new${index}`).css('display', 'none');
        $(`#toggle-origin${index}`).css('display', 'block');
            }
}
```



## ì™„ì„± ì½”ë“œ

### app.py

```python
from flask import Flask, render_template, jsonify, request
from pymongo import MongoClient
from bson.json_util import dumps
from bson.objectid import ObjectId


app = Flask(__name__)

db = MongoClient('localhost', 27017).dbjungle
# AWS ì„œë²„ ë°°í¬ ì£¼ì†Œ
# db = MongoClient('mongodb://test:test@3.34.142.63', 27017).dbjungle


@app.route('/')
def home():
    return render_template('index.html')


@app.route('/api/list', methods=['GET'])
def get_articel():
    # 1. ëª¨ë“  document ì°¾ê¸°
    result = list(db.memos.find().sort('like', -1))
    return jsonify({'result': 'success', 'posting': dumps(result)})


@app.route('/api/post', methods=['POST'])
def post_article():
    # 1. í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ë°ì´í„°ë¥¼ ë°›ê¸°
    title_receive = request.form['title_give']
    contents_receive = request.form['contents_give']

    doc = {
        'title_receive': title_receive,
        'contents_receive': contents_receive,
        'like': 0
    }

    # 2. mongoDBì— ë°ì´í„°ë¥¼ ë„£ê¸°
    db.memos.insert_one(doc)

    return jsonify({'result': 'success'})


@app.route('/api/update', methods=['POST'])
def update_article():
    id_receive = request.form['id']
    update_title_receive = request.form['new_title_give']
    update_contents_receive = request.form['new_contents_give']
    db.memos.update_one({'_id': ObjectId(id_receive)},
                        {'$set': {'title_receive': update_title_receive, 'contents_receive': update_contents_receive}})
    return jsonify({'result': 'success'})


@app.route('/api/delete', methods=['POST'])
def delete_article():
    # 1. í´ë¼ì´ì–¸íŠ¸ê°€ ì „ë‹¬í•œ id_give id_receive ë³€ìˆ˜ì— ë„£ìŠµë‹ˆë‹¤.
    id_receive = request.form['id_give']
    # 2. id_receiveì™€ ì¼ì¹˜í•˜ëŠ” idë¥¼ ì œê±°í•©ë‹ˆë‹¤.
    db.memos.delete_one({'_id': ObjectId(id_receive)})
    # 3. ì„±ê³µí•˜ë©´ success ë©”ì‹œì§€ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
    return jsonify({'result': 'success'})


@app.route('/api/like', methods=['POST'])
def like_star():
    # 1. í´ë¼ì´ì–¸íŠ¸ê°€ ì „ë‹¬í•œ id_giveë¥¼ id_receive ë³€ìˆ˜ì— ë„£ìŠµë‹ˆë‹¤.
    id_receive = request.form['id_give']
    # 2. id_receiveì™€ ì¼ì¹˜í•˜ëŠ” idë¥¼ ì°¾ìŠµë‹ˆë‹¤.
    article = db.memos.find_one({'_id': ObjectId(id_receive)})
    # 3. articleì˜ like ì— 1ì„ ë”í•´ì¤€ new_like ë³€ìˆ˜ë¥¼ ë§Œë“­ë‹ˆë‹¤.
    new_like = article['like'] + 1
    # 4. í•´ë‹¹ articleì˜ like ë¥¼ new_likeë¡œ ë³€ê²½í•©ë‹ˆë‹¤.
    db.memos.update_one({'_id': ObjectId(id_receive)},
                        {'$set': {'like': new_like}})
    # 5. ì„±ê³µí•˜ë©´ success ë©”ì‹œì§€ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
    return jsonify({'result': 'success'})


if __name__ == '__main__':
    app.run('0.0.0.0', port=5000, debug=True)

```

### index.html

```html
<!Doctype html>
<html lang="ko">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
        integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">

    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <!-- êµ¬ê¸€í°íŠ¸ -->
    <link href="https://fonts.googleapis.com/css?family=Stylish&display=swap" rel="stylesheet">


    <title>í¬ë˜í”„í†¤ì •ê¸€ | ë‚˜í™€ë¡œ ë©”ëª¨ì¥</title>

    <!-- style -->
    <style type="text/css">
        * {
            font-family: "Stylish", sans-serif;
        }

        span {
            background-color: gray;
            color: whitesmoke;
        }

        .wrap {
            width: 900px;
            margin: auto;
        }

        .comment {
            color: blue;
            font-weight: bold;
        }

        #post-box {
            width: 500px;
            border-radius: 5px;
        }
    </style>
    <script>
        $(document).ready(function () {
            showArticles();
        });

        function showArticles() {
            $.ajax({
                type: "GET",
                url: "/api/list",
                data: {},
                success: function (response) {
                    // JSON ë°ì´í„°ë¥¼ ê°ì²´ë¡œ ë³€ê²½
                    let articles = JSON.parse(response['posting']);
                    for (let i = 0; i < articles.length; i++) {
                        let title = articles[i]['title_receive'];
                        let contents = articles[i]['contents_receive'];
                        let like = articles[i]['like'];
                        let id = articles[i]['_id']['$oid'];

                        let tempHtml = `<div class="card">
                                            <div id="toggle-new${i}" style="padding: 10px; display: none">
                                                <div class="form-group">
                                                    <input id="update-title${i}" value="" class="form-control new-title">
                                                </div>
                                                <div class="form-group">
                                                    <textarea id="update-contents${i}" class="form-control new-text" rows="2" >${contents}</textarea>
                                                </div>
                                                <button onclick="updateArticle('${id}, ${contents}, ${i}')" type="button" class="btn btn-success save-button">ì €ì¥</button>
                                            </div>

                                            <div id="toggle-origin${i}" class="card-body">
                                                <p id="id-title${i}" class="card-title" alt="Paragraph">${title}</p>
                                                <p id="id-contents${i}" class="card-text">${contents}</p>
                                                <p class="card-likes">${like}</p>
                                                <button onclick="cardToggle(${i})" type="button" class="btn btn-info edit-button">ìˆ˜ì •</button>
                                                <button onclick="deleteArticle('${id}')" type="button" class="btn btn-danger delete-button">ì‚­ì œ</button>
                                                <a href="#" onclick="likeStar('${id}')" class="link-like">ì¢‹ì•„ìš”!</a>
                                            </div>
                                        </div>`;
                        $("#card-list").append(tempHtml);
                    }
                }
            })
        }

        function postArticle() {
            // ì œëª©, ë‚´ìš© ë¹ˆ ê°’ ì²´í¬
            let checkTitle = $("#memo-title").val();
            let checkContents = $("#memo-content").val();
            if (checkTitle == '') {
                alert("ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return
            } else if (checkContents == '') {
                alert("ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return
            }

            let title = $("#memo-title").val();
            let contents = $("#memo-content").val();

            // 1. POST ë°©ì‹ìœ¼ë¡œ ë©”ëª¨ ìƒì„± ìš”ì²­í•˜ê¸°
            $.ajax({
                type: "POST", // POST ë°©ì‹ìœ¼ë¡œ ìš”ì²­
                url: "/api/post", // /api/postingë¼ëŠ” urlì— ìš”ì²­
                data: { 'title_give': title, 'contents_give': contents }, // ë°ì´í„°ë¥¼ ì£¼ëŠ” ë°©ë²•
                success: function (response) { // ì„±ê³µí•˜ë©´
                    if (response["result"] == "success") {
                        // 2. ì„±ê³µ ì‹œ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨í•˜ê¸°
                        window.location.reload();
                    }
                }
            });
        }

        // 'ìˆ˜ì • ë²„íŠ¼ í´ë¦­ ì‹œ í† í´'
        function cardToggle(index) {
            let status = $(`#toggle-origin${index}`).css('display');

            if (status == 'block') {
                $(`#toggle-new${index}`).css('display', 'block');
                $(`#toggle-origin${index}`).css('display', 'none');
                $(`#update-title${index}`).attr('value', $(`#id-title${index}`).text());
            } else {
                $(`#toggle-new${index}`).css('display', 'none');
                $(`#toggle-origin${index}`).css('display', 'block');
            }

        }

        function updateArticle(title, contents, index) {
            let temp = title.split(', ');
            let id = temp[0]
            let new_title = $(`#update-title${temp[2]}`).val();
            let new_contents = $(`#update-contents${temp[2]}`).val();
            $.ajax({
                type: 'POST',
                url: '/api/update',
                data: {},
                data: { 'id': id, 'new_title_give': new_title, 'new_contents_give': new_contents },
                success: function (response) {
                    if (response['result'] == 'success') {
                        // 2. ì„±ê³µ ì‹œ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨í•˜ê¸°
                        window.location.reload();
                    }
                }
            });
        }

        function deleteArticle(id) {
            $.ajax({
                type: 'POST',
                url: '/api/delete',
                data: { 'id_give': id },
                success: function (response) {
                    if (response['result'] == 'success') {
                        alert('ì‚­ì œ ì™„ë£Œ!');
                    }
                    window.location.reload();
                }
            });
        }

        function likeStar(id) {
            $.ajax({
                type: 'POST',
                url: '/api/like',
                data: { 'id_give': id },
                success: function (response) {
                    if (response['result'] == 'success') {
                        alert("ì¢‹ì•„ìš” ì™„ë£Œ!");
                    }
                    window.location.reload();
                }
            });
        }
    </script>
</head>

<body>
    <div class="wrap">
        <div class="jumbotron">
            <h1 class="display-4">ë‚˜í™€ë¡œë©”ëª¨ì¥ <span>ver2.0</span></h1>
            <div id="post-box" class="form-post" style="display:block">
                <div>
                    <div class="form-group">
                        <input id="memo-title" class="form-control" placeholder=" ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="form-group">
                        <textarea id="memo-content" class="form-control" rows="2" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                    </div>
                </div>
            </div>
            <button type="submit" class="btn btn-primary" onclick="postArticle()">ì €ì¥í•˜ê¸°</button>
        </div>
        <div id="card-list" class="card-columns">
        </div>
    </div>
</body>

</html>
```





### 