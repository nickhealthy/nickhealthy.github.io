---
title: '[êµìœ¡] PaaS-TA êµìœ¡2ì¼ì°¨'
date: 2021-10-19 14:22:13
category: 'â˜ï¸ cloud'
draft: false
---

boshVMë¥¼ ë°°í¬í•˜ê³ , ê·¸ ìœ„ì— PaaS-TA ë°°í¬ ë° CF-CLI(Cloud-Foundry)ë¥¼ í†µí•´ ì œì–´í•´ ë´…ì‹œë‹¤.

## PaaS-TAë€?

- <u>í´ë¼ìš°ë“œ ì¸í”„ë¼ í™˜ê²½ì„ ì œì–´</u>í•˜ë©´ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‰½ê²Œ ê°œë°œí•˜ê³  ì•ˆì •ì ìœ¼ë¡œ ìš´ì˜í•  ìˆ˜ ìˆë„ë¡ <u>ê´€ë¦¬ Â· ì§€ì›í•˜ëŠ” í´ë¼ìš°ë“œ í”Œë«í¼</u>

![17  PASS-TA](https://user-images.githubusercontent.com/66216102/137826533-595cf2f9-df42-422c-b12a-7d36c293a351.JPG)

## ë‹¨ê³„ë³„ ê°œë°œ ì§„í–‰(2017 ~ 2019)

- PaaS-TA ê°œë°œ ê³¼ì •

![17-1  PASS-TA](https://user-images.githubusercontent.com/66216102/137826536-d3ecfc3c-f929-4cc5-a2fd-db51f3a03bd4.JPG)

![17-2  PASS-TA](https://user-images.githubusercontent.com/66216102/137826538-740da409-982e-47d2-9c3c-a5145c448c0f.JPG)

![17-3  PASS-TA](https://user-images.githubusercontent.com/66216102/137826541-a91b2483-47b6-4ccd-8f3c-99ffa6ed746f.JPG)

![17-4  PASS-TA](https://user-images.githubusercontent.com/66216102/137826545-c6f60546-2e74-4b10-91b9-25cabe4916bd.JPG)

## íŒŒìŠ¤íƒ€ 5.5 version - SEMINI

- PaaS-TAì˜ ìµœì‹  ë²„ì „(v5.5) ì´ë©°, <u>ì˜¤í”ˆì†ŒìŠ¤ ê¸°ë°˜ì˜ í´ë¼ìš°ë“œíŒŒìš´ë“œë¦¬ì™€ ì¿ ë²„ë„¤í‹°ìŠ¤ ê¸°ë°˜ì˜ ì»¨í…Œì´í„°í”Œë«í¼ì„ ì œê³µ</u>í•˜ì—¬ ì•±ì˜ ê°œë°œ ë° ë°°í¬, ì‹¤í–‰, ìš´ì˜ê´€ë¦¬ ì„œë¹„ìŠ¤ ì œê³µ
- ì„¸ë¯¸ë‹ˆì˜ íŠ¹ì§•

![17-5  PASS-TA](https://user-images.githubusercontent.com/66216102/137826546-10a785b5-9c9a-4ded-a797-1c6ab1097246.JPG)

- í”Œë«í¼ë³„ ë³‘í–‰ ìš´ì˜ ê°€ëŠ¥(ì´ì „ ë²„ì „ì—ì„œëŠ” ë¶ˆê°€ëŠ¥)

![17-6  PASS-TA](https://user-images.githubusercontent.com/66216102/137826549-e452689a-0c0e-47f6-a455-9ac42c860944.JPG)

## í•µì‹¬ ê¸°ëŠ¥

![17-7  PASS-TA](https://user-images.githubusercontent.com/66216102/137826551-9a15172d-d35d-49c8-b2a4-3329bba6be06.JPG)

![17-8  PASS-TA](https://user-images.githubusercontent.com/66216102/137826554-b60100b4-65e0-4ecf-9b79-9d7ad7ffaa18.JPG)

## íŒŒìŠ¤íƒ€ í”Œë«í¼ ì‚¬ìš© ê°€ì´ë“œ

![17-9  PASS-TA](https://user-images.githubusercontent.com/66216102/137826558-eb068fef-58f2-4883-b514-b41e280a4e44.JPG)

## íŒŒìŠ¤íƒ€ì˜ ì¥ì 

![18  good](https://user-images.githubusercontent.com/66216102/137826560-cceba17a-939c-4fd2-a997-c69188d7cf84.JPG)

![18-1  good](https://user-images.githubusercontent.com/66216102/137826562-c0e59287-6734-469e-a733-5f0b24d287be.JPG)

![18-2  good](https://user-images.githubusercontent.com/66216102/137826563-7f395c0c-f068-4234-8f0b-f26d1ee1155c.JPG)

## í•µì‹¬ ì •ë¦¬

![19  summary](https://user-images.githubusercontent.com/66216102/137826565-c354c956-b38c-497a-aee0-fc85e8a2cfd9.JPG)

## PaaS-TA ë°°í¬ë¥¼ ìœ„í•œ ê¸°ë³¸ êµ¬ì„±

### IaaS ì¢…ë¥˜

![19-1  Iaas](https://user-images.githubusercontent.com/66216102/137826566-e70dec94-3f64-4ebd-9883-6e96cc39c88d.JPG)

![19-2  Iaas](https://user-images.githubusercontent.com/66216102/137826568-f4d26dc3-f2a0-4d2a-bbad-9b999c3aba3c.JPG)

![19-3  Iaas](https://user-images.githubusercontent.com/66216102/137826570-47c96206-443c-4c83-bcae-2bf7f2a3d6f7.JPG)

![19-4  Iaas](https://user-images.githubusercontent.com/66216102/137826571-9f95fdb5-77fd-4d22-8eba-78c29b15381e.JPG)

![19-5  Iaas](https://user-images.githubusercontent.com/66216102/137826573-d26e3947-357f-4b3c-b169-7ddf7a90ca50.JPG)

## BOSH ê°œë…

- IaaSë¥¼ ì œì–´í•˜ëŠ” í”„ë¡œê·¸ë¨ìœ¼ë¡œ VMë¥¼ ì„¤ì¹˜í•˜ê±°ë‚˜ ê´€ë¦¬í•˜ëŠ” ë„êµ¬

![20  bosh](https://user-images.githubusercontent.com/66216102/137826574-fe57657a-388e-4ea6-a6c0-af0d9597732d.JPG)

![20-1  bosh](https://user-images.githubusercontent.com/66216102/137826575-d3d890b9-d5d3-49ba-bdd3-ef38a530d5a1.JPG)

- Boshë¥¼ í†µí•´ì„œ ì„¤ì¹˜í•  ìˆ˜ ìˆëŠ” í”„ë¡œê·¸ë¨ì„ <u>ë¦´ë¦¬ì¦ˆ</u>ë¼ê³  í•©ë‹ˆë‹¤.

![20-2  bosh](https://user-images.githubusercontent.com/66216102/137826576-aad5b23a-87b1-4755-8441-098bc3e798e4.JPG)

### BOSH ì»´í¬ë„ŒíŠ¸ êµ¬ì„±

![20-3  bosh](https://user-images.githubusercontent.com/66216102/137826577-ed1bcd48-3908-4c48-83f2-17c17ab662dc.JPG)

![20-4  bosh](https://user-images.githubusercontent.com/66216102/137826579-d5c7c333-32cc-4738-a951-10a867a9a413.JPG)

### Bosh êµ¬ì„±ìš”ì†Œ

- ëŒ€í‘œì ìœ¼ë¡œ ì´ 3ê°€ì§€ê°€ ìˆìŒ(Release, Stemcell, Manifest)

![1  bosh êµ¬ì„±ìš”ì†Œ](https://user-images.githubusercontent.com/66216102/138245992-7f4dac29-ae3f-45b7-a698-1e21776621bf.JPG)

#### ë¦´ë¦¬ì¦ˆ êµ¬ì„±ìš”ì†Œ

![2  ë¦´ë¦¬ì¦ˆ êµ¬ì„±ìš”ì†Œ](https://user-images.githubusercontent.com/66216102/138245998-68d53988-adf9-4b78-8c71-0687ac648d3b.JPG)

#### Stemcellì˜ êµ¬ì„±ìš”ì†Œ

- Stemcellì€ VMì— ì˜¬ë¼ê°€ëŠ” Agentë¥¼ ì˜ë¯¸í•¨
- <u>OSì´ë¯¸ì§€ì™€ Agentë¥¼ ì„¤ì¹˜í•´ì„œ í•˜ë‚˜ì˜ íŒŒì¼ì„ ë§Œë“  ê²ƒì´ Stemcell</u> ì´ë¼ê³  ë¶ˆë ¤ì§

![3  ìŠ¤í…œì‰˜ êµ¬ì„±ìš”ì†Œ](https://user-images.githubusercontent.com/66216102/138246000-e9201f66-94b9-442a-b241-65dce141805a.JPG)

#### Manifest

- BOSH Deployment manifestëŠ” components ìš”ì†Œ ë° ë°°í¬ì˜ ì†ì„±ì„ ì •ì˜í•œ YAML íŒŒì¼
  - Deployment manifest ì—ëŠ” sotfwareë¥¼ ì„¤ì¹˜ í•˜ê¸° ìœ„í•´ì„œ ì–´ë–¤ <u>Stemcell(OS, BOSH agent)</u> ì„ ì‚¬ìš©í•  ê²ƒì´ë©°,
  - <u>Release(Software packages, Config templates, Scripts) ì´ë¦„ê³¼ ë²„ì „, VMs ìš©ëŸ‰, Jobs params</u> ë“±ì„ ì •ì˜í•˜ì—¬ Bosh deploy CLI ì„ ì´ìš©í•˜ì—¬ software(ì—¬ê¸°ì„œëŠ” ì„œë¹„ìŠ¤íŒ©)ë¥¼ ì„¤ì¹˜ í•¨

#### Bosh1 vs Bosh2

- ê¸°ì¡´ ë²„ì „ì¸ Bosh1ì€ Bosh-CLIë¥¼ í†µí•´ Bosh-VMë¥¼ ìƒì„±í•˜ê³ , PaaS-TAì˜ ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ì»¨í…Œì´ë„ˆë¥¼ ë”°ë¡œ ìƒì„±í•´ì£¼ì–´ì•¼ í–ˆì§€ë§Œ,
- Bosh2ëŠ” Bosh-CLIë¥¼ í†µí•´ Bosh-VMë¥¼ ìƒì„±í•˜ê³ , <u>PaaS-TAì˜ ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ì»¨í…Œì´ë„ˆë¥¼ í•œë²ˆì— ì„¤ì¹˜í•  ìˆ˜ ìˆìŒ</u>

## PaaS-TAë¥¼ ì„¤ì¹˜í•˜ê¸° ìœ„í•œ Bosh í™˜ê²½ êµ¬ì„± ì„¤ëª…

### Director(BoshVM)

- **PaaS-TAë¥¼ ì„¤ì¹˜í•˜ê¸° ìœ„í•´ í•„ìš”í•œ íŒ¨í‚¤ì§€ ë° ë¼ì´ë¸ŒëŸ¬ë¦¬, Manifest íŒŒì¼ ë“±ì˜ í™˜ê²½ì„ ê°€ì§€ê³  ìˆëŠ” ë°°í¬ ì‘ì—… ë° ì‹¤í–‰ ì„œë²„**
- Inception ì„œë²„ëŠ” BOSH ì„¤ì¹˜ì™€ BOSHì˜ Directorë¥¼ ì„¤ì •
- <u>í™˜ê²½ êµ¬ì„±ì— ìˆì–´ì„œ ì „ì œì¡°ê±´ìœ¼ë¡œ Inception ì„œë²„ëŠ” ì™¸ë¶€ì™€ í†µì‹ ì´ ê°€ëŠ¥í•´ì•¼ í•¨</u>

#### Paas-TAë¥¼ ì„¤ì¹˜í•˜ê¸° ìœ„í•œ Bosh íŒŒì¼ êµ¬ì„±

![5  ë³´ì‰¬ ê°€ìƒë¨¸ì‹  ì„¤ì¹˜](https://user-images.githubusercontent.com/66216102/138246004-0578e910-b7e5-4ef7-bda8-7ed1b1374c41.JPG)

#### deployment ì´í•˜ ë””ë ‰í† ë¦¬

![5-1  ë³´ì‰¬ ê°€ìƒë¨¸ì‹  ì„¤ì¹˜](https://user-images.githubusercontent.com/66216102/138246006-5215caec-b803-465c-aa99-13fbb066d88c.JPG)

#### release, stemcell íŒŒì¼ êµ¬ì„±

![5-2  ë³´ì‰¬ ê°€ìƒë¨¸ì‹  ì„¤ì¹˜](https://user-images.githubusercontent.com/66216102/138246009-9628cf15-8586-470d-9cdf-0b7bbf06d4c6.JPG)

#### ë¯¸ë¦¬ ì•Œì•„ë‘ê¸°

- Bosh-VM ìƒì„± ì‹œ, IaaS ì„¤ì •ì€ Bosh-Commandë¥¼ ì´ìš©í•´ì•¼ í•˜ë©°, <u>ê°ê°ì˜ IaaS ë§ˆë‹¤ ì˜µì…˜ ê°’ì´ ë³€ê²½ë  ìˆ˜ ìˆìŒ</u>

![5-3  ë³´ì‰¬ ê°€ìƒë¨¸ì‹  ì„¤ì¹˜](https://user-images.githubusercontent.com/66216102/138246011-a1b72037-ce62-4f6e-8547-3509f88197ec.JPG)

## Bosh ì•„í‚¤í…ì²˜(ì¼ë°˜ì , í…ŒìŠ¤íŠ¸(ë¡œì»¬) í™˜ê²½)

- ì‹¤ìŠµ ë•Œ, bosh-liteë¥¼ ì´ìš©í•  ì˜ˆì •
  - Boshì—ì„œ ìì²´ì ìœ¼ë¡œ ì œê³µí•´ì£¼ê³  ìˆìŒ
- ì¼ë°˜ì ì¸ Bosh ì•„í‚¤í…ì²˜ ì´ìš© ì‹œ, <u>ê°ê°ì˜ Bosh ì»´í¬ë„ŒíŠ¸ë¥¼ VMìœ¼ë¡œ ë§Œë“¤ì–´ ìš´ì˜í•¨</u>(uaa, diego, blob store, credhub)
  - ë¬¼ë¡  BoshVM ë˜í•œ VMì´ë©°, IaaS í™˜ê²½ì—ì„œ PaaS-TAì˜ VMë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ë„êµ¬ì´ì VMì„
- Bosh-lite(í…ŒìŠ¤íŠ¸ í™˜ê²½)ì„ ì´ìš© ì‹œ, <u>BoshVM ì•ˆì— ê°ê°ì˜ Bosh ì»´í¬ë„ŒíŠ¸ë¥¼ ì»¨í…Œì´ë„ˆí™” ì‹œì¼œì„œ ìš´ì˜í•¨</u>

![4  ë³´ì‰¬ ì „ì²´ ì•„í‚¤í…ì²˜](https://user-images.githubusercontent.com/66216102/138246003-b16902ee-31ce-4a7a-b6d9-c05d0071d954.JPG)

## LAB 1 - BOSH ì„¤ì¹˜

> VMwareë¥¼ í†µí•œ Inception(VM)ì˜ ì„¤ì¹˜ ê³¼ì •ì€ ìƒëµ  
> [Paas-TA 5.5 ì„¤ì¹˜ ë§í¬](https://nextcloud.paas-ta.org/index.php/s/ARmoNN83XGgt2gg)

- íŒŒìŠ¤íƒ€ ì„¤ì¹˜ì— í•„ìš”í•œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë° ì••ì¶• í•´ì œ ìŠ¤í¬ë¦½íŠ¸

```bash
$ sudo apt install curl
$ mkdir workspace
# (workspace ì•„ë˜ì— PaaS-TA ì„¤ì¹˜ íŒŒì¼ ë‹¤ìš´ë¡œë“œ í›„ ì••ì¶• í•´ì œ)
$ cd workspace
$ curl -Lo paasta-5.5.zip https://nextcloud.paasta.org/index.php/s/ARmoNN83XGgt2gg/download
$ unzip paasta-5.5.zip
```

- Bosh ì„¤ì¹˜

```bash
$ curl -Lo ./bosh https://s3.amazonaws.com/bosh-cli-artifacts/bosh-cli-6.1.0-linux-amd64
$ chmod +x ./bosh
$ sudo mv ./bosh /usr/local/bin/bosh
$ bosh -v
```

- ì¢…ì†ì„± íŒŒì¼ ì„¤ì¹˜

```bash
$ sudo apt-get install -y build-essential zlibc zlib1g-dev ruby ruby-dev openssl libxslt1-dev libxml2-dev libssl-dev libreadline7 libreadline-dev libyaml-dev libsqlite3-dev sqlite3
```

- Bosh-VM(Bosh-lite)ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•œ VirtualBox ì„¤ì¹˜

```bash
$ sudo apt update
$ sudo apt upgrade
$ wget -q https://www.virtualbox.org/download/oracle_vbox_2016.asc -O- | sudo apt-key add -
$ wget -q https://www.virtualbox.org/download/oracle_vbox.asc -O- | sudo apt-key add -
$ sudo add-apt-repository "deb http://download.virtualbox.org/virtualbox/debian bionic contrib"
$ sudo apt update
$ sudo apt install virtualbox-6.0
$ VBoxManage --version
# 6.0.14r133895
```

- bosh-deployment í´ë” í™•ì¸

![7  bosh-deployment í´ë”](https://user-images.githubusercontent.com/66216102/138246017-62fb411c-ec6d-4f8e-9b5e-476bc5d25728.JPG)

- ì‹¤ìŠµì— ì‚¬ìš©í•  Bosh-lite ì‰˜ ìŠ¤í¬ë¦½íŠ¸ì˜ ì •ë³´
  - <u>ìœ„ì—ì„œë„ ì–¸ê¸‰í–ˆì§€ë§Œ, ê°ê°ì˜ IaaS ë§ˆë‹¤ ì„¤ì •í•´ì¤˜ì•¼ í•˜ëŠ” ì„¤ì • ê°’ì€ ë‹¤ë¦„</u>(ë™ì¼í•œ ë¶€ë¶„ë„ ì¡´ì¬)

```bash
$ cat deploy-bosh-lite.sh

#!/bin/bash

bosh create-env bosh.yml \
	--state=warden/state.json \
	--vars-store warden/creds.yml \		# bosh ì¸ì¦ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©°, í•´ë‹¹ íŒŒì¼ì„ ì´ìš©í•´ boshì— ë¡œê·¸ì¸
	-o virtualbox/cpi.yml \
	-o virtualbox/outbound-network.yml \
	-o bosh-lite.yml \
	-o bosh-lite-runc.yml \
	-o uaa.yml \
	-o credhub.yml \					# Credhubì€ ì¸ì¦ì •ë³´ ì €ì¥ì†Œ, Bosh ì„¤ì¹˜ ì‹œ credhub.ymlì„ ì ìš©í•˜ë©´ PaaS-TA ì„¤ì¹˜ ì‹œ ì¸ì¦ì •ë³´ë¥¼ credhubì— ì €ì¥í•˜ê²Œ ë¨
	-o jumpbox-user.yml \				# bosh VMì— ì ‘ê·¼í•˜ê¸° ìœ„í•œ ì¸ì¦ì„ ì ìš©í•˜ëŠ” íŒŒì¼
	-v inception_os_user_name='ubuntu' \
	-v director_name='micro-bosh' \
	-v internal_cidr='10.0.1.0/24' \
	-v internal_gw='10.0.1.1' \
	-v internal_ip='10.0.1.6' \
	-v network_name='vboxnet0' \
	-v outbound_network_name='NatNetwork'
```

- [ì°¸ê³ ] IaaS ë§ˆë‹¤ ì„¤ì •í•´ì¤˜ì•¼ í•˜ëŠ” ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ì°¨ì´ í™•ì¸(AWSì™€ Bosh-lite ë¹„êµ)

![6  boshvm ë°°í¬](https://user-images.githubusercontent.com/66216102/138246014-6b0a8680-5de5-4397-91be-4d9423d8ba5d.JPG)

![6-1  boshvm ë°°í¬](https://user-images.githubusercontent.com/66216102/138246016-30d1556f-f5a1-440e-b75a-1f98297d8ed7.JPG)

- BOSH-VM ë°°í¬
  - _~/workspace/paasta-5.5/deployment/bosh-deployment_ ì´í•˜ ë””ë ‰í† ë¦¬ì—ëŠ” IaaSë³„ boshë¥¼ ì„¤ì¹˜ í•˜ëŠ” shellì´ ì¡´ì¬
  - `{iaas}`ì€ í•´ë‹¹í•˜ëŠ” IaaSì˜ ì´ë¦„(bosh-lite, Openstack, AWS, GCP etc..)

```bash
$ cd ~/workspace/paasta-5.5/deployment/bosh-deployment
$ chmod 755 *.sh
$ ./deploy-{iaas}.sh
```

![8  bosh deploy](https://user-images.githubusercontent.com/66216102/138246019-19720946-c213-4a9e-bd3e-76d5cb0232e2.JPG)

- Bosh Alias ì„¤ì •

```bash
$ bosh alias-env micro-bosh -e 10.0.1.6 --ca-cert <(bosh int warden/creds.yml --path /director_ssl/ca)
```

<div class="quote-block">
<div class="quote-block__emoji">ğŸ’¡</div>
<div class="quote-block__content" markdown=1>

BoshVM login ë°©ë²•ì€ ì´ 2ê°€ì§€ê°€ ìˆìŒ

1. login ì‰˜ì„ í†µí•´ boshVMì— ë¡œê·¸ì¸ í›„ ëª…ë ¹ì–´ë¥¼ ì´ìš©í•˜ëŠ” ë°©ë²•
2. boshVM ì•ˆì— ì ‘ì†í•˜ê¸° ìœ„í•œ jumpbox.keyë¥¼ ìƒì„±í•´ SSHë¡œ ë¡œê·¸ì¸í•˜ëŠ” ë°©ë²•

</div>
</div>

- Bosh login ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±

```bash
$ vi login.sh

#!/usr/bin

export BOSH_CA_CERT=$(bosh int ./warden/creds.yml --path /director_ssl/ca)
export BOSH_CLIENT=admin
export BOSH_CLIENT_SECRET=$(bosh int ./warden/creds.yml --path /admin_password)
```

- Bosh login ì‰˜ ì ìš© ë° í™•ì¸(login.sh ì„ ì´ìš©í•´ boshì— ë¡œê·¸ì¸)

```bash
$ source login.sh
$ bosh -e micro-bosh env
```

- jumpbox key ìƒì„± (Bosh VM ë¡œê·¸ì¸ ìš©)
  - SSHë¡œ BoshVMì— ë¡œê·¸ì¸í•˜ê¸° ìœ„í•œ jumpbox key ìƒì„±

```bash
$ bosh int warden/creds.yml --path /jumpbox_ssh/private_key > jumpbox.key
$ chmod 600 jumpbox.key
```

- BoshVMìœ¼ë¡œ ë°°í¬ëœ í”„ë¡œê·¸ë¨ process í™•ì¸ (bosh vm or paas-ta vm ssh ì ‘ì† í›„ ì´ìš©)

```bash
$ ssh jumpbox@10.0.1.6 -i jumpbox.key # boshVM ë¡œê·¸ì¸
bosh/0:~$ sudo su
$ monit summary
```

![9  í”„ë¡œì„¸ì„œ í™•ì¸](https://user-images.githubusercontent.com/66216102/138246022-70f4544f-7cb3-4302-8565-fa75c2fdc83b.JPG)

- boshVMì— ë°°í¬ëœ process ì •ì§€ ë° ì‹œì‘ ëª…ë ¹ì–´

```bash
# ì •ì§€ ëª…ë ¹ì–´
$ monit stop credhub
# ì‹œì‘ ëª…ë ¹ì–´
$ monit start credhub
# boshVMì—ì„œ ë‚˜ê°€ê¸°
$ exit # root ê³„ì • logout
$ exit # jumpbox ê³„ì • logout
```

- credhub cli ì„¤ì¹˜
  - serverìª½ì— not foundê°€ ëœ¨ëŠ” ì´ìœ ëŠ” ë¡œê·¸ì¸ì„ í•˜ì§€ ì•Šì•˜ê¸° ë–„ë¬¸ì— ë‚˜íƒ€ë‚˜ëŠ” í˜„ìƒì„

```bash
$ cd ~
$ wget https://github.com/cloudfoundry-incubator/credhub-cli/releases/download/2.0.0/credhub-linux-2.0.0.tgz
$ tar -xvf credhub-linux-2.0.0.tgz
$ chmod +x credhub
$ sudo mv credhub /usr/local/bin/credhub
$ credhub --version
```

![10  credhub](https://user-images.githubusercontent.com/66216102/138246025-8d27a7a2-1565-4c89-9fbc-f21735f62b37.JPG)

- credhub shell ìƒì„±

```bash
$ cd ~/workspace/paasta-5.5/deployment/bosh-deployment
$ vi credhub_login.sh
...
#!/usr/bin

export CREDHUB_CLIENT=credhub-admin
export CREDHUB_SECRET=$(bosh int --path /credhub_admin_client_secret warden/creds.yml)
export CREDHUB_CA_CERT=$(bosh int --path /credhub_tls/ca warden/creds.yml)
...
```

- credhub shell ì‰˜ ì ìš©

```bash
$ cd ~/workspace/paasta-5.5/deployment/bosh-deployment
$ source credhub_login.sh
```

- credhub ë¡œê·¸ì¸

```bash
$ credhub login -s https://10.0.1.6:8844 --skip-tls-validation
```

![10-1  credhub](https://user-images.githubusercontent.com/66216102/138246026-7a62cc52-0fdf-45b3-9e9e-7bf152ca5ffb.JPG)

- credhub credentials í™•ì¸
  - credentials ì¸ì¦ ì •ë³´ê°€ í•˜ë‚˜ë„ ì¡°íšŒë˜ì§€ ì•ŠëŠ”ë°, ì´ëŠ” boshVMë§Œ ìƒì„±í•˜ê³  ì•„ë¬´ëŸ° ì‘ì—…ì„ í•˜ì§€ ì•Šì•„ ë‚˜íƒ€ë‚˜ëŠ” í˜„ìƒ
  - boshVMì— process VMë¥¼ ë°°í¬í•˜ê²Œ ë˜ë©´, <u>**credhubì— ì¸ì¦ì •ë³´ê°€ ì €ì¥ë©ë‹ˆë‹¤.**</u>

```bash
$ credhub find
```

- VirtualBox í™˜ê²½ì €ì¥ ë° ì¢…ë£Œ(boshVM)

```bash
# /home/ubuntu/workspace/paasta-5.5/deployment/bosh-deployment í•´ë‹¹ ë””ë ‰í† ë¦¬ì—ì„œ ì •ì§€ ì‘ì—…ì„ í•´ì•¼í•¨
$ cd /home/ubuntu/workspace/paasta-5.5/deployment/bosh-deployment
$ vboxmanage controlvm $(bosh int warden/state.json --path /current_vm_cid) savestate
```

- ì´í›„ Inception ì„œë²„ ì¢…ë£Œ
  - **<u>Inception ì„œë²„ ì¬ê¸°ë™ ì‹œ, VirtualBoxë¥¼ ë°›ë“œì‹œ ì¬ê¸°ë™ í•´ì•¼í•¨</u>**

```bash
# Virtual Box vm ë³µêµ¬
$ cd /home/ubuntu/workspace/paasta-5.5/deployment/bosh-deployment
$ vboxmanage startvm $(bosh int warden/state.json --path /current_vm_cid) --type headless
```

## BOSHë¥¼ í†µí•œ PaaS-TA êµ¬ì¶• ë°©ë²•

### Cloud-config

#### ë¯¸ë¦¬ ì•Œì•„ë‘ê¸°

![1  íŒŒìŠ¤íƒ€êµ¬ì¶•cloud-config](https://user-images.githubusercontent.com/66216102/138425196-0c9578d9-1c04-4b93-b025-251fa952fb43.JPG)

#### yaml íŒŒì¼ì— ì •ë¦¬ëœ ìŠ¤í¬ë¦½íŠ¸ ìš©ì–´ì •ë¦¬

- `azs`ëŠ” ê°€ìš© zoneì— ëŒ€í•œ ì„¤ì •ìœ¼ë¡œ paastaê°€ ì„¤ì¹˜ë  zoneì— ëŒ€í•œ ì •ì˜
- `vm_type`ì€ paasta vmì´ ì„¤ì¹˜ë  specì„ ì •ì˜í•˜ë©°, `instance_type`ì€ openstack flavorì— ì„¤ì • ë˜ì–´ ìˆì–´ì•¼ í•¨
- `compilation`ì€ PaaS-TA ì„¤ì¹˜ ì‹œ Compile VMì´ ìƒì„±ë  <u>zone ë° vm typeì„ ì„¤ì •</u>
- `disk_types`ëŠ” PaaS-TA ì„¤ì¹˜ ì‹œ ì‚¬ìš©ë  <u>VMì˜ ë””ìŠ¤í¬ì— ëŒ€í•œ ì •ì˜</u>
- `network`ì€ paasta vmì´ ìƒì„±ë  <u>networkê´€ë ¨ ì •ì˜</u>
- `vm_extentions`ëŠ” ê´€ë ¨ ë³´ì•ˆ ê·¸ë£¹ ë° ë¡œë“œ ë°¸ëŸ°ì„œì™€ ê°™ì€ <u>ì„ì˜ì˜ IaaS íŠ¹ì • êµ¬ì„±ì„ ì§€ì •í•  ìˆ˜ ìˆëŠ” í´ë¼ìš°ë“œ êµ¬ì„±ì˜ ê°€ìƒ ì»´í“¨í„° êµ¬ì„±</u>
- ì„¤ì •ëœ cloud-config.yml íŒŒì¼ì„ ë°°í¬í•˜ëŠ” ëª…ë ì–´
  - ì•„ë˜ ì½”ë“œëŠ” <u>bosh-lite IaaS</u>ì„ ê¸°ì¤€ìœ¼ë¡œ í•¨

![1-1  íŒŒìŠ¤íƒ€êµ¬ì¶•cloud-config](https://user-images.githubusercontent.com/66216102/138425199-ba66708a-632d-452b-8486-084f14807569.JPG)

```bash
# Cloud-configì„¤ì • ì •ë³´ë¥¼ BOSHì— update
$ cd ~/workspace/paasta-5.5/deployment/cloud-config
$ bosh â€“e {director_name} update-cloud-config {iaas}_cloud_config.yml
# boshì— uploadëœ cloud-config í™•ì¸
$ bosh â€“e {director_name} cloud-config
```

- boshì— uploadëœ cloud-config í™•ì¸

```bash
$ bosh â€“e {director_name} cloud-config
```

### runtime-configì„¤ì • ì •ë³´ë¥¼ BOSHì— update ì˜ˆì œ

```bash
$ cd ~/workspace/paasta-5.5/deployment/bosh-deployment
$ chmod 755 ./update-runtime-config.sh
$ cat ./update-runtime-config.sh

[update-runtime-config.sh]
...
bosh -e ${director_name} update-runtime-config -n runtime-configs/dns.yml \
-v inception_os_user_name=${inception_os_user_name} \
-v cert_days=3650
...

$ ./update-runtime-config.sh
```

- boshì— uploadëœ runtime-config í™•ì¸

```bash
$ bosh â€“e {director_name} runtime-config
```

### Stemcell íŒŒì¼ì„ BOSHì— update ì˜ˆì œ

```bash
$ cd ~/workspace/paasta-5.5/stemcell/paasta
$ bosh â€“e {director_name} upload-stemcell bosh-stemcell-315.64-{iaas}-
ubuntu-xenial-go-agent.tgz
```

- boshì— uploadëœ Stemcell í™•ì¸

```bash
$ bosh â€“e {director_name} stemcells
```

### manifest íŒŒì¼ ë¶„ì„ ë° ë°°í¬ ì˜ˆì‹œ

- **_paasta-deployment.yml_ íŒŒì¼ì€ paastaë¥¼ deployí•˜ëŠ” manifest file**
- paasta vmì— ëŒ€í•œ ì„¤ì¹˜ë¥¼ ì •ì˜
- <u>vmì¤‘ singleton-blobstore, databaseì˜ azs(zone)ì„ ë³€ê²½ í•˜ë©´ Org & Space ë° appì˜ ì •ë³´ê°€ ëª¨ë‘ ì‚­ì œë¨</u>

- ì•„ë˜ optionë“¤ì€ ì¡´ì¬ í•˜ì§€ ì•Šìœ¼ë©´ boshê°€ ìë™ ìƒì„±í•´ì¤Œ

![1  manifest íŒŒì¼ ë¶„ì„ ë° ë°°í¬ì˜ˆì‹œ](https://user-images.githubusercontent.com/66216102/138062379-7f4aee9f-48b5-4234-b548-c20e5a4befa5.JPG)

![2  ë§¤ë‹ˆí˜ìŠ¤íŠ¸íŒŒì¼](https://user-images.githubusercontent.com/66216102/138425203-fa877337-dfef-49da-8e96-e5e7374c50a7.JPG)

- PaaS-TA Deploy ì‹¤í–‰

```bash
$ ./deploy-bosh-lite.sh
```

- PaaS-TA Deploy VM í™•ì¸

```bash
$ bosh -e {director_name} â€“d {deploy_name} vms
```

## LAB 2 - BoshVMì— PaaS-TA êµ¬ì¶• ì‹¤ìŠµ

BoshVMì— íŒŒìŠ¤íƒ€ë¥¼ ì„¤ì¹˜í•  ì •ë³´ë¥¼ <u>Cloud-config, runtime-config, stemcell</u> ë¥¼ í™•ì¸ ë° êµ¬ì¶•í•˜ê¸°

- Virtual Box vm ë³µêµ¬**<u>(ì´ì „ì— VM ì¢…ë£Œ ì‹œ ê¼­ ë‹¤ì‹œ ì‹¤í–‰!)</u>**

```bash
$ cd /home/ubuntu/workspace/paasta-5.5/deployment/bosh-deployment
$ vboxmanage startvm $(bosh int warden/state.json --path /current_vm_cid) --type headless
```

- Bosh login

```bash
$ cd ~/workspace/paasta-5.5/deployment/bosh-deployment
$ source login.sh
```

- Bosh login í™•ì¸

```bash
$ bosh -e micro-bosh env
```

- cloud-config ì ìš©

```bash
$ bosh -e micro-bosh update-cloud-config bosh-lite-cloud-config.yml
```

- cloud-config ì„¤ì • í™•ì¸

```bash
$ cd ~/workspace/paasta-5.5/deployment/bosh-deployment
$ bosh -e micro-bosh cloud-config
```

- update-runtime-config.sh ìŠ¤í¬ë¦½íŠ¸ í™•ì¸
  - `-n runtime-configs/dns.yml` : ëŸ°íƒ€ì„ ì •ë³´ê°€ ë“¤ì–´ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸
  - `-v cert_days=3650` : ì¸ì¦ ê¸°ê°„ì„ ë‚˜íƒ€ëƒ„

```bash
#!/bin/bash
# ë””ë ‰í† ë¦¬ ë„¤ì„
director_name='micro-bosh'
# os_user_name
inception_os_user_name='ubuntu'

bosh -e ${director_name} update-runtime-config -n runtime-configs/dns.yml \
	-v inception_os_user_name=${inception_os_user_name} \
	-v cert_days=3650
```

- runtime config ë“±ë¡

```bash
$ ./update-runtime-config.sh
```

- runtime config í™•ì¸

```bash
$ bosh -e micro-bosh runtime-config
```

- bosh config ì „ì²´ í™•ì¸
  - cloud : IaaS ì„¤ì • config(cloud-config.yml)
  - runtime : runtime ì„¤ì •(runtime/dns.yml)

```bash
$ bosh -e micro-bosh configs
```

![3  config ì •ë³´í™•ì¸](https://user-images.githubusercontent.com/66216102/138425206-80cf1480-2d47-4393-90f4-d624ec9e8169.JPG)

- stemcell ë“±ë¡

```bash
$ cd ~/workspace/paasta-5.5/stemcell/paasta
$ bosh -e micro-bosh upload-stemcell bosh-stemcell-315.64-warden-boshlite-ubuntu-xenial-go_agent.tgz
```

- stemcell ë“±ë¡ í™•ì¸

```bash
$ bosh -e micro-bosh stemcells
```

![3-1  config ì •ë³´í™•ì¸](https://user-images.githubusercontent.com/66216102/138425210-3d6cea5a-f0c8-473c-9ad9-addf2dcab254.JPG)

- íŒŒìŠ¤íƒ€ ë°°í¬í•˜ê¸°

```bash
cd ~/workspace/paasta-5.5/deployment/paasta-deployment
$ ./deploy-bosh-lite.sh
```

- IP route ì„¤ì • (bosh-liteë¥¼ ì´ìš©í• ë•Œ)

```bash
$ sudo ip route add   10.244.0.0/16 via 10.0.1.6
```

## ê¸°íƒ€ ì‹¤ìŠµ

- PaaS-TA VMì—ì„œ ìƒì„±ëœ instancesë¥¼ ì¶œë ¥í•˜ëŠ” ëª…ë ¹ì–´(ë°°í¬ë˜ì§€ ì•Šì€ ê²ƒë„ í¬í•¨í•´ì„œ ë‚˜ì˜´)
  - ë°°í¬ë¥¼ ëˆ„ê°€ í–ˆëŠ”ì§€ ì¶œë ¥

```bash
$ bosh -e micro-bosh instances
```

- BoshVM ì •ë³´ì˜ ìƒì„¸ì •ë³´ í™•ì¸(ë¡œê·¸ì¸ ì •ë³´, ì¸ì¦ ìœ íš¨ê¸°ê°„ í™•ì¸)

```bash
$ bosh -e micro-bosh env --details
```

- í˜„ì¬ ì˜¬ë¼ê°€ ìˆëŠ” ìŠ¤í…œì…€ ì •ë³´ í™•ì¸

```bash
$ bosh -e micro-bosh stemcells
```

- VMì— ì–´ë–¤ releases ì •ë³´ê°€ ë“¤ì–´ê°€ ìˆëŠ”ì§€ ì•Œì•„ë³´ëŠ” ëª…ë ¹ì–´

```bash
$ bosh -e micro-bosh releases
```

- í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ TASKë“¤ì„ í™•ì¸

```bash
$ bosh -e micro-bosh tasks --recent
```

- ì‘ì—…ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí•´ lockì´ ê±¸ë¦° TASKë¥¼ ë³´ì—¬ì¤Œ

```bash
$ bosh -e micro-bosh locks
```

- TASK-IDì´ìš©í•´ì„œ TASKë¥¼ ì¢…ë£Œ

```bash
$ bosh -e micro-bosh cancel-task 123
```

- ë°°í¬ëœ VM ì •ë³´ && ë””ìŠ¤í¬, CPU, ë©”ëª¨ë¦¬ì— ëŒ€í•œ ì •ë³´ë¥¼ ì¢…í•© í™•ì¸
  - `--vitals` ì˜µì…˜ : ë””í…Œì¼í•˜ê²Œ í™•ì¸

```bash
$ bosh -e micro-bosh -d paasta vms --vitals
```

- PaaS-TAì— ë°°í¬ëœ VMë“¤ì„ í™•ì¸(instances ëª…ë ¹ì–´ì™€ëŠ” ë‹¤ë¥´ê²Œ VMì— ë°°í¬ëœ instances ë“¤ë§Œ ì¶œë ¥)
  - VMì— ëŒ€í•œ ì •ë³´ í¬í•¨í•´ì„œ ì•Œë ¤ì¤Œ

```bash
$ bosh -e micro-bosh -d paasta vms
```

- API VMì— ì ‘ì†
  - API VMì´ ì—¬ëŸ¬ ê°œì¼ ì‹œ ë’¤ì— ê³ ìœ ë²ˆí˜¸ë„ ì ì–´ì¤˜ì•¼í•¨
  - BoshVM ì•ˆì— ì ‘ì†í•˜ë ¤ë©´ jumpbox.keyë¥¼ ì´ìš©í•´ì•¼í–ˆë˜ ê±°ì™€ ê°™ì´ <u>paasta ì•ˆì— ì ‘ì†í•˜ë ¤ë©´ apië¡œ ì ‘ê·¼</u>

```bash
$ bosh -e micro-bosh -d paasta ssh api
```

- ë§Œì•½ ì ‘ì†í•œ VMì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•  ì‹œ ë¡œê·¸ í™•ì¸ ê²½ë¡œ
  - <u>vmì— ë¡œê·¸ì¸í•˜ê²Œë˜ë©´ var/vcap ê²½ë¡œì—ì„œ ì—¬ëŸ¬ ì •ë³´ë¥¼ ì—´ëŒí•  ìˆ˜ ìˆìŒ.</u>
  - ë‚´ë¶€ ì˜¤ë¥˜ ë°œìƒì‹œ ì´ê³³ì—ì„œ sys/log ì— ë“¤ì–´ê°€ ë¡œê·¸ë¥¼ í™•ì¸í•˜ê±°ë‚˜, íŒŒì¼ ë§í¬ ìƒíƒœ(jobs), ì—ì´ì „íŠ¸ì— ëŒ€í•œ ì •ë³´, íŒŒì¼ë“¤ì„ ë³¼ ìˆ˜ ìˆìŒ.

```bash
$ cd var/vcap/sys/log
```

## PaaS-TAë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ cf-cli ì„¤ì¹˜ ë° ëª…ë ¹ì–´ ì‚¬ìš©

- ì„¤ì¹˜ë¥¼ ìœ„í•œ ë ˆí¬ì§€í† ë¦¬ í‚¤ ë“±ë¡ ë° ë ˆí¬ì§€í† ë¦¬ ë“±ë¡

```bash
$ wget -q -O - https://packages.cloudfoundry.org/debian/cli.cloudfoundry.org.key | sudo apt-key add -
$ echo "deb https://packages.cloudfoundry.org/debian stable main" | sudo tee /etc/apt/sources.list.d/cloudfoundry-cli.list
```

- ë ˆí¬ì§€í† ë¦¬ ì—…ë°ì´íŠ¸ && Cloud Foundary ì—ì„œ ì œê³µí•˜ëŠ” cf-cli ì„¤ì¹˜ && ë²„ì „ í™•ì¸

```bash
$ sudo apt update
$ sudo apt install cf-cli
$ cf -v
```

- cf login
  - `--skip-ssl-validation` ì˜µì…˜ : PaaS-TAì— ë¡œê·¸ì¸ ì‹œ, SSL ì¸ì¦ ì ˆì°¨ë¥¼ ê±°ì¹˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— í•´ë‹¹ ì‚¬ì´íŠ¸ë¥¼ ì‹ ë¢°í•˜ê³  ê²€ì¦í•˜ì§€ ì•Šì•„ë„ ëœë‹¤ëŠ” ëª…ë ¹ì–´
  - ì´í›„ì— API-Endpoint ì„ ì…ë ¥í•˜ëŠ” ì°½ì´ ë‚˜ì˜¤ê²Œ ë˜ëŠ”ë°, ì´ëŠ” <u>VM ì•ˆì— ì„¤ì¹˜ëœ PaaS-TAì—ê²Œ ì–´ë””ì— ì ‘ì†í•´ì•¼ í•˜ëŠ”ì§€ ì•Œë ¤ì¤˜ì•¼ í•˜ë¯€ë¡œ, ì„¤ì •í•˜ëŠ” ì˜µì…˜ì„</u>
  - í•´ë‹¹ URLì€ paastaë¥¼ ë°°í¬í•  ë•Œ, ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì„¤ì •í•œ `-v system_domain=10.244.0.34.nip.io` ì˜µì…˜ì— í•´ë‹¹ë˜ë©°, í•´ë‹¹ URLë¥¼ apië¡œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— api ë„ë©”ì¸ì„ ì…ë ¥ í›„ ì„œë¸Œ ë„ë©”ì¸ì„(10.244.0.34.nip.io) ì…ë ¥í•´ì£¼ëŠ” ê²ƒì„
  - ë‹¤ë¥¸ ë„ë©”ì¸ì„ ì‚¬ìš©í•œë‹¤ê³  í•˜ë”ë¼ë„, api ë„ë©”ì¸ ì…ë ¥ í›„ ì„œë¸Œ ë„ë©”ì¸ì„ ì…ë ¥í•  ê²ƒ

```bash
$ cf login --skip-ssl-validation
(ëª…ë ¹ ìˆ˜í–‰ í›„ API Endpoit :  ì´ ëœ¨ë©´ ì•„ë˜ https://api.10.244.0.34.nip.io ë¥¼ ì…ë ¥í•œë‹¤)

$ https://api.10.244.0.34.nip.io # SSL ì¸ì¦ì„œë¥¼ ì¸ì¦í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— í•´ë‹¹ PaaS-TA ipë¥¼ í—ˆìš©í•œë‹¤ê³  ì•Œë ¤ì¤˜ì•¼í•¨

# passta deploymentì—ì„œ ë¡œê·¸ì¸ ì •ë³´ ë³€ê²½ ê°€ëŠ¥
$ admin/admin # ê´€ë¦¬ìë¡œ ë¡œê·¸ì¸ - ì´ë©”ì¼/íŒ¨ìŠ¤ì›Œë“œ ì…ë ¥
```

- ë¡œê·¸ì¸ í›„ í™”ë©´ ëª¨ìŠµ
  - OrgëŠ” ìë™ì ìœ¼ë¡œ ì„¤ì •ë¨(admin ê³„ì •ì´ í•˜ë‚˜ì´ë¯€ë¡œ)
  - SpaceëŠ” ì„¤ì •ë˜ì§€ ì•Šì€ ëª¨ìŠµ

![1  í´ë¼ìš°ë“œíŒŒìš´ë°ì´ì…˜ ë¡œê·¸ì¸](https://user-images.githubusercontent.com/66216102/138887176-29720432-0d4e-4879-9362-860f87a04f7e.JPG)

> ìì„¸í•œ cf ëª…ë ¹ì–´ì— ëŒ€í•œ ì •ë³´ëŠ” `cf --help` or `cf --help -a` ëª…ë ¹ì–´ë¡œ í™•ì¸ ê°€ëŠ¥

- user ìƒì„±

```bash
# $ cf create-user --help ì²˜ëŸ¼ --help ëª…ë ¹ì–´ ì‚¬ìš©ê°€ëŠ¥
$ cf create-user edu-user user
```

- org ìƒì„±

```bash
$ cf create-org edu-org
$ cf orgs
```

- space ìƒì„±
  - `-o` ì˜µì…˜ : organization ì„ ëœ»í•˜ë©°, -o ì˜µì…˜ì„ ë¶™ì´ì§€ ì•Šì„ ì‹œ, ê¸°ë³¸ì ìœ¼ë¡œ í˜„ì¬ ì„¤ì •ëœ orgì— space ê³µê°„ì„ ë§Œë“¬
  - í˜„ì¬ ì„¤ì •ëœ ì •ë³´ë¥¼ í™•ì¸í•˜ëŠ” ëª…ë ¹ì–´ëŠ” `cf target` ëª…ë ¹ì–´ì„

```bash
$ cf create-space -o edu-org edu-space
$ cf spaces
```

- org role ì„¤ì •
  - ìì„¸í•œ ì •ë³´ëŠ” `cf set-org-role --help` ëª…ë ¹ì–´ë¡œ í™•ì¸ ê°€ëŠ¥

```bash
$ cf set-org-role edu-user edu-org OrgManager
```

- space role ì„¤ì •
  - ìì„¸í•œ ì •ë³´ëŠ” `cf set-space-role --help` ëª…ë ¹ì–´ë¡œ í™•ì¸ ê°€ëŠ¥

```bash
$ cf set-space-role edu-user edu-org edu-space SpaceDeveloper
```

- ìƒì„±í•œ org, spaceì˜ íƒ€ì¼“ì„ ì„¤ì •í•¨

```bash
$ cf target -o edu-org -s edu-space  (ì•„ë‹ˆë©´ cf target -o edu-org)
```

## LAB 3 - CFì—ì„œ ì œê³µí•´ì£¼ëŠ” spring-music ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬í•´ë³´ê¸°

- ìë°” 8ë²„ì „ ì„¤ì¹˜

```bash
$ sudo apt update
$ sudo apt install openjdk-8-jdk
$ java -version
```

- git ì„¤ì¹˜

```bash
$ sudo apt install git
$ git --version
```

- spring-music ë‹¤ìš´ë¡œë“œ ë° ë¹Œë“œ
  - gredle ë¡œ í•´ë‹¹ íŒŒì¼ì„ ë¹Œë“œ

```bash
$ cd ~/workspace
$ git clone https://github.com/cloudfoundry-samples/spring-music
$ cd spring-music/
$ ./gradlew clean assemble
```

- manifest íŒŒì¼ í™•ì¸

```bash
$ cat manifest.yml

---
applications:
- name: spring-music
  memory: 1G
  random-route: true # URLì„ ìë™ì ìœ¼ë¡œ ë§Œë“¤ì–´ì¤Œ
  path: build/libs/spring-music-1.0.jar
  env:
    JBP_CONFIG_SPRING_AUTO_RECONFIGURATION: '{enabled: false}'
    SPRING_PROFILES_ACTIVE: http2
#    JBP_CONFIG_OPEN_JDK_JRE: '{ jre: { version: 11.+ } }'
```

- cf push ëª…ë ¹ì–´ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ ë° ì• í”Œë¦¬ì¼€ì´ì…˜ í™•ì¸(ì•„ë˜ëŠ” pushì˜ ê³¼ì •ì„ ì„¤ëª…)
  1. droplet ì´ë¯¸ì§€ë¥¼ ë§Œë“¬
  2. blobstoreì— ì´ë¯¸ì§€ë¥¼ ì €ì¥
  3. blobstoreì— ì €ì¥í•œ ì´ë¯¸ì§€ì¸ droplet ì´ë¯¸ì§€ íŒŒì¼ì„ êº¼ë‚´ì„œ diegoCell ì— gradenë¥¼ ë§Œë“¬
  4. ì´í›„ garden ìœ„ì— ì»¨í…Œì´ë„ˆ í˜•íƒœë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬
  5. cf appsë¡œ ë°°í¬ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ í™•ì¸ ê°€ëŠ¥
  6. ì´ë•Œ ìœ„ì—ì„œ ë³¸ manifest.yml íŒŒì¼ì—ì„œ ì„¤ì •í•œ `random-route: true` ë¡œ ì¸í•´ URLì´ ìë™ì ìœ¼ë¡œ ìƒì„±ë˜ê³ , apps ëª…ë ¹ì–´ë¥¼ í†µí•´ í™•ì¸ì´ ê°€ëŠ¥

```bash
$ cf push
$ cf apps
```

- ë¡œê·¸ í™•ì¸

```bash
$ cf app spring-music
$ cf logs spring-music
$ cf logs spring-music --recent
```

- cfë¥¼ ì´ìš©í•œ ssh í„°ë„ë§

```bash
$ cf ssh welcome-cf -L 9999:10.10.4.14:3306
```
