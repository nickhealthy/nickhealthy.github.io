{"componentChunkName":"component---src-templates-blog-post-js","path":"/cloud/[AWS] ALB와 NLB를 통한 로드밸런싱/","result":{"data":{"site":{"siteMetadata":{"title":"Woo's Dev Log","author":"nickhealthy","siteUrl":"https://nickhealthy.github.io","comment":{"disqusShortName":"","utterances":"nickhealthy/nickhealthy.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"d7581bf5-c339-5294-9b9b-4603c5040ced","excerpt":"실습목표 ELB의 3가지 유형의 로드밸런싱 중에 ALB와 NLB를 생성하여 부하 분산을 통한 고가용성 환경을 구성하고, 각 로드밸런서의 차이와 통신 과정을 살펴봄 실습 단계 기본 환경 구성 CloudFormation 적용 생성 자원 확인 기본 환경 검증 ALB를 통한 로드밸런싱 ALB 생성 ALB 검증 NLB를 통한 로드밸런싱 NLB 생성 NLB 검증 자원 삭제 기본 환경 구성 CloudFormation 적용 이전 실습 확인 AWS 인프라 자원을 생성할 YAML 파일 VPC(10.0.0.0/1…","html":"<h2 id=\"실습목표\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%EC%8A%B5%EB%AA%A9%ED%91%9C\" aria-label=\"실습목표 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실습목표</h2>\n<ul>\n<li>ELB의 3가지 유형의 로드밸런싱 중에 ALB와 NLB를 생성하여 부하 분산을 통한 고가용성 환경을 구성하고, 각 로드밸런서의 차이와 통신 과정을 살펴봄</li>\n</ul>\n<h2 id=\"실습-단계\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%EC%8A%B5-%EB%8B%A8%EA%B3%84\" aria-label=\"실습 단계 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실습 단계</h2>\n<h3 id=\"기본-환경-구성\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%EB%B3%B8-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1\" aria-label=\"기본 환경 구성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>기본 환경 구성</h3>\n<ul>\n<li>CloudFormation 적용</li>\n<li>생성 자원 확인</li>\n<li>기본 환경 검증</li>\n</ul>\n<h3 id=\"alb를-통한-로드밸런싱\" style=\"position:relative;\"><a href=\"#alb%EB%A5%BC-%ED%86%B5%ED%95%9C-%EB%A1%9C%EB%93%9C%EB%B0%B8%EB%9F%B0%EC%8B%B1\" aria-label=\"alb를 통한 로드밸런싱 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ALB를 통한 로드밸런싱</h3>\n<ul>\n<li>ALB 생성</li>\n<li>ALB 검증</li>\n</ul>\n<h3 id=\"nlb를-통한-로드밸런싱\" style=\"position:relative;\"><a href=\"#nlb%EB%A5%BC-%ED%86%B5%ED%95%9C-%EB%A1%9C%EB%93%9C%EB%B0%B8%EB%9F%B0%EC%8B%B1\" aria-label=\"nlb를 통한 로드밸런싱 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NLB를 통한 로드밸런싱</h3>\n<ul>\n<li>NLB 생성</li>\n<li>NLB 검증</li>\n</ul>\n<h3 id=\"자원-삭제\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EC%9B%90-%EC%82%AD%EC%A0%9C\" aria-label=\"자원 삭제 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자원 삭제</h3>\n<h2 id=\"기본-환경-구성-1\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%EB%B3%B8-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1-1\" aria-label=\"기본 환경 구성 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>기본 환경 구성</h2>\n<h3 id=\"cloudformation-적용\" style=\"position:relative;\"><a href=\"#cloudformation-%EC%A0%81%EC%9A%A9\" aria-label=\"cloudformation 적용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CloudFormation 적용</h3>\n<ul>\n<li>이전 실습 확인</li>\n<li>\n<p>AWS 인프라 자원을 생성할 [YAML 파일]</p>\n<ul>\n<li>VPC(10.0.0.0/16, 20.0.0.0/16)</li>\n<li>퍼블릭 서브넷(ELB-Public-SN-1, ELB-Public-SN-2, My-Public-SN)</li>\n<li>퍼블릭 라우팅 테이블(ELB-Public-RT, My-Public-RT)</li>\n<li>인터넷 게이트웨이(ELB-IGW, My-IGW)</li>\n<li>퍼블릭 EC2 인스턴스(My-EC2, ELB-EC2-1, ELB-EC2-2)</li>\n<li>보안그룹(ELB-SG) - 프로토콜: SSH, HTTP, SNMP/대상(0.0.0.0/0)</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">Parameters</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">KeyName</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Description</span><span class=\"token punctuation\">:</span> Name of an existing EC2 KeyPair to enable SSH access to the instances. Linked to AWS Parameter\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>KeyPair<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>KeyName\n    <span class=\"token key atrule\">ConstraintDescription</span><span class=\"token punctuation\">:</span> must be the name of an existing EC2 KeyPair.\n  <span class=\"token key atrule\">LatestAmiId</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Description</span><span class=\"token punctuation\">:</span> (DO NOT CHANGE)\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'AWS::SSM::Parameter::Value&lt;AWS::EC2::Image::Id>'</span>\n    <span class=\"token key atrule\">Default</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'/aws/service/ami-amazon-linux-latest/amzn2-ami-hvm-x86_64-gp2'</span>\n    <span class=\"token key atrule\">AllowedValues</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> /aws/service/ami<span class=\"token punctuation\">-</span>amazon<span class=\"token punctuation\">-</span>linux<span class=\"token punctuation\">-</span>latest/amzn2<span class=\"token punctuation\">-</span>ami<span class=\"token punctuation\">-</span>hvm<span class=\"token punctuation\">-</span>x86_64<span class=\"token punctuation\">-</span>gp2\n\n<span class=\"token key atrule\">Resources</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">ELBVPC</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>VPC\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">CidrBlock</span><span class=\"token punctuation\">:</span> 10.0.0.0/16\n      <span class=\"token key atrule\">Tags</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Name\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> ELB<span class=\"token punctuation\">-</span>VPC\n\n  <span class=\"token key atrule\">MyVPC</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>VPC\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">CidrBlock</span><span class=\"token punctuation\">:</span> 20.0.0.0/16\n      <span class=\"token key atrule\">Tags</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Name\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> My<span class=\"token punctuation\">-</span>VPC\n\n  <span class=\"token key atrule\">ELBIGW</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>InternetGateway\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">Tags</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Name\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> ELB<span class=\"token punctuation\">-</span>IGW\n\n  <span class=\"token key atrule\">MyIGW</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>InternetGateway\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">Tags</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Name\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> My<span class=\"token punctuation\">-</span>IGW\n\n  <span class=\"token key atrule\">ELBIGWAttachment</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>VPCGatewayAttachment\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">InternetGatewayId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> ELBIGW\n      <span class=\"token key atrule\">VpcId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> ELBVPC\n\n  <span class=\"token key atrule\">MyIGWAttachment</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>VPCGatewayAttachment\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">InternetGatewayId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> MyIGW\n      <span class=\"token key atrule\">VpcId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> MyVPC\n\n  <span class=\"token key atrule\">ELBPublicRT</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>RouteTable\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">VpcId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> ELBVPC\n      <span class=\"token key atrule\">Tags</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Name\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> ELB<span class=\"token punctuation\">-</span>Public<span class=\"token punctuation\">-</span>RT\n\n  <span class=\"token key atrule\">ELBDefaultPublicRoute</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>Route\n    <span class=\"token key atrule\">DependsOn</span><span class=\"token punctuation\">:</span> ELBIGWAttachment\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">RouteTableId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> ELBPublicRT\n      <span class=\"token key atrule\">DestinationCidrBlock</span><span class=\"token punctuation\">:</span> 0.0.0.0/0\n      <span class=\"token key atrule\">GatewayId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> ELBIGW\n\n  <span class=\"token key atrule\">MyPublicRT</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>RouteTable\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">VpcId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> MyVPC\n      <span class=\"token key atrule\">Tags</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Name\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> My<span class=\"token punctuation\">-</span>Public<span class=\"token punctuation\">-</span>RT\n\n  <span class=\"token key atrule\">MyDefaultPublicRoute</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>Route\n    <span class=\"token key atrule\">DependsOn</span><span class=\"token punctuation\">:</span> MyIGWAttachment\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">RouteTableId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> MyPublicRT\n      <span class=\"token key atrule\">DestinationCidrBlock</span><span class=\"token punctuation\">:</span> 0.0.0.0/0\n      <span class=\"token key atrule\">GatewayId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> MyIGW\n\n  <span class=\"token key atrule\">ELBPublicSN1</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>Subnet\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">VpcId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> ELBVPC\n      <span class=\"token key atrule\">AvailabilityZone</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Select</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token tag\">!GetAZs</span> <span class=\"token string\">''</span><span class=\"token punctuation\">]</span>\n      <span class=\"token key atrule\">CidrBlock</span><span class=\"token punctuation\">:</span> 10.0.0.0/24\n      <span class=\"token key atrule\">Tags</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Name\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> ELB<span class=\"token punctuation\">-</span>Public<span class=\"token punctuation\">-</span>SN<span class=\"token punctuation\">-</span><span class=\"token number\">1</span>\n\n  <span class=\"token key atrule\">ELBPublicSN2</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>Subnet\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">VpcId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> ELBVPC\n      <span class=\"token key atrule\">AvailabilityZone</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Select</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token tag\">!GetAZs</span> <span class=\"token string\">''</span><span class=\"token punctuation\">]</span>\n      <span class=\"token key atrule\">CidrBlock</span><span class=\"token punctuation\">:</span> 10.0.1.0/24\n      <span class=\"token key atrule\">Tags</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Name\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> ELB<span class=\"token punctuation\">-</span>Public<span class=\"token punctuation\">-</span>SN<span class=\"token punctuation\">-</span><span class=\"token number\">2</span>\n\n  <span class=\"token key atrule\">MyPublicSN</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>Subnet\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">VpcId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> MyVPC\n      <span class=\"token key atrule\">AvailabilityZone</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Select</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token tag\">!GetAZs</span> <span class=\"token string\">''</span><span class=\"token punctuation\">]</span>\n      <span class=\"token key atrule\">CidrBlock</span><span class=\"token punctuation\">:</span> 20.0.0.0/24\n      <span class=\"token key atrule\">Tags</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Name\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> My<span class=\"token punctuation\">-</span>Public<span class=\"token punctuation\">-</span>SN\n\n  <span class=\"token key atrule\">ELBPublicSNRouteTableAssociation</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>SubnetRouteTableAssociation\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">RouteTableId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> ELBPublicRT\n      <span class=\"token key atrule\">SubnetId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> ELBPublicSN1\n\n  <span class=\"token key atrule\">ELBPublicSNRouteTableAssociation2</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>SubnetRouteTableAssociation\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">RouteTableId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> ELBPublicRT\n      <span class=\"token key atrule\">SubnetId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> ELBPublicSN2\n\n  <span class=\"token key atrule\">MyPublicSNRouteTableAssociation</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>SubnetRouteTableAssociation\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">RouteTableId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> MyPublicRT\n      <span class=\"token key atrule\">SubnetId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> MyPublicSN\n\n  <span class=\"token key atrule\">MySG</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>SecurityGroup\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">GroupDescription</span><span class=\"token punctuation\">:</span> Enable HTTP access via port 80 and SSH access via port 22\n      <span class=\"token key atrule\">VpcId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> MyVPC\n      <span class=\"token key atrule\">Tags</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Name\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> My<span class=\"token punctuation\">-</span>SG\n      <span class=\"token key atrule\">SecurityGroupIngress</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">IpProtocol</span><span class=\"token punctuation\">:</span> tcp\n          <span class=\"token key atrule\">FromPort</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'22'</span>\n          <span class=\"token key atrule\">ToPort</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'22'</span>\n          <span class=\"token key atrule\">CidrIp</span><span class=\"token punctuation\">:</span> 0.0.0.0/0\n\n  <span class=\"token key atrule\">ELBSG</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>SecurityGroup\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">GroupDescription</span><span class=\"token punctuation\">:</span> Enable HTTP access via port 80 and SSH access via port 22\n      <span class=\"token key atrule\">VpcId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> ELBVPC\n      <span class=\"token key atrule\">Tags</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Name\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> ELBSG\n      <span class=\"token key atrule\">SecurityGroupIngress</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">IpProtocol</span><span class=\"token punctuation\">:</span> tcp\n          <span class=\"token key atrule\">FromPort</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'80'</span>\n          <span class=\"token key atrule\">ToPort</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'80'</span>\n          <span class=\"token key atrule\">CidrIp</span><span class=\"token punctuation\">:</span> 0.0.0.0/0\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">IpProtocol</span><span class=\"token punctuation\">:</span> udp\n          <span class=\"token key atrule\">FromPort</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'161'</span>\n          <span class=\"token key atrule\">ToPort</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'161'</span>\n          <span class=\"token key atrule\">CidrIp</span><span class=\"token punctuation\">:</span> 0.0.0.0/0\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">IpProtocol</span><span class=\"token punctuation\">:</span> tcp\n          <span class=\"token key atrule\">FromPort</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'22'</span>\n          <span class=\"token key atrule\">ToPort</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'22'</span>\n          <span class=\"token key atrule\">CidrIp</span><span class=\"token punctuation\">:</span> 0.0.0.0/0\n\n  <span class=\"token key atrule\">MyEC2</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>Instance\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">InstanceType</span><span class=\"token punctuation\">:</span> t2.micro\n      <span class=\"token key atrule\">ImageId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> LatestAmiId\n      <span class=\"token key atrule\">KeyName</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> KeyName\n      <span class=\"token key atrule\">Tags</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Name\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> My<span class=\"token punctuation\">-</span>EC2\n      <span class=\"token key atrule\">NetworkInterfaces</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">DeviceIndex</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n          <span class=\"token key atrule\">SubnetId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> MyPublicSN\n          <span class=\"token key atrule\">GroupSet</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token tag\">!Ref</span> MySG\n          <span class=\"token key atrule\">AssociatePublicIpAddress</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n      <span class=\"token key atrule\">UserData</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">Fn::Base64</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Sub</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n          #!/bin/bash\n          yum install net-snmp-utils -y</span>\n\n  <span class=\"token key atrule\">ELBEC21</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>Instance\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">InstanceType</span><span class=\"token punctuation\">:</span> t2.micro\n      <span class=\"token key atrule\">ImageId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> LatestAmiId\n      <span class=\"token key atrule\">KeyName</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> KeyName\n      <span class=\"token key atrule\">Tags</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Name\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> ELB<span class=\"token punctuation\">-</span>EC2<span class=\"token punctuation\">-</span><span class=\"token number\">1</span>\n      <span class=\"token key atrule\">NetworkInterfaces</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">DeviceIndex</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n          <span class=\"token key atrule\">SubnetId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> ELBPublicSN1\n          <span class=\"token key atrule\">GroupSet</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token tag\">!Ref</span> ELBSG\n          <span class=\"token key atrule\">AssociatePublicIpAddress</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n      <span class=\"token key atrule\">UserData</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">Fn::Base64</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Sub</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n          #!/bin/bash\n          hostname ELB-EC2-1\n          yum install httpd -y\n          yum install net-snmp net-snmp-utils -y\n          yum install tcpdump -y\n          service httpd start\n          chkconfig httpd on\n          service snmpd start\n          chkconfig snmpd on\n          echo \"&lt;h1>ELB-EC2-1 Web Server&lt;/h1>\" > /var/www/html/index.html\n          mkdir /var/www/html/dev\n          echo \"&lt;h1>ELB-EC2-1 Dev Web Page&lt;/h1>\" > /var/www/html/dev/index.html</span>\n\n  <span class=\"token key atrule\">ELBEC22</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>Instance\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">InstanceType</span><span class=\"token punctuation\">:</span> t2.micro\n      <span class=\"token key atrule\">ImageId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> LatestAmiId\n      <span class=\"token key atrule\">KeyName</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> KeyName\n      <span class=\"token key atrule\">Tags</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Name\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> ELB<span class=\"token punctuation\">-</span>EC2<span class=\"token punctuation\">-</span><span class=\"token number\">2</span>\n      <span class=\"token key atrule\">NetworkInterfaces</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">DeviceIndex</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n          <span class=\"token key atrule\">SubnetId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> ELBPublicSN2\n          <span class=\"token key atrule\">GroupSet</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token tag\">!Ref</span> ELBSG\n          <span class=\"token key atrule\">AssociatePublicIpAddress</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n      <span class=\"token key atrule\">UserData</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">Fn::Base64</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Sub</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n          #!/bin/bash\n          hostname ELB-EC2-2\n          yum install httpd -y\n          yum install net-snmp net-snmp-utils -y\n          yum install tcpdump -y\n          service httpd start\n          chkconfig httpd on\n          service snmpd start\n          chkconfig snmpd on\n          echo \"&lt;h1>ELB-EC2-2 Web Server&lt;/h1>\" > /var/www/html/index.html\n          mkdir /var/www/html/mgt\n          echo \"&lt;h1>ELB-EC2-2 Mgt Web Page&lt;/h1>\" > /var/www/html/mgt/index.html</span></code></pre></div>\n<h3 id=\"기본-환경-검증\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%EB%B3%B8-%ED%99%98%EA%B2%BD-%EA%B2%80%EC%A6%9D\" aria-label=\"기본 환경 검증 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>기본 환경 검증</h3>\n<ul>\n<li>My-EC2 인스턴스에서 <em>ELb-EC2-1과 ELB-EC2-2</em>로 HTTP 서비스와 SNMP 서비스 확인</li>\n<li>각 인스턴스의 퍼블릭 IP 확인한 후 My-EC2 인스턴스에서 SSH로 접근</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649312-a0bcf780-d864-11eb-9daf-ff3844796dbd.JPG\" alt=\"1 기본환경검증\"></p>\n<h2 id=\"alb를-통한-로드밸런싱-1\" style=\"position:relative;\"><a href=\"#alb%EB%A5%BC-%ED%86%B5%ED%95%9C-%EB%A1%9C%EB%93%9C%EB%B0%B8%EB%9F%B0%EC%8B%B1-1\" aria-label=\"alb를 통한 로드밸런싱 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ALB를 통한 로드밸런싱</h2>\n<h3 id=\"alb-생성\" style=\"position:relative;\"><a href=\"#alb-%EC%83%9D%EC%84%B1\" aria-label=\"alb 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ALB 생성</h3>\n<ul>\n<li>경로: 서비스 - EC2 - 로드밸런싱 - 로드밸런서 - 로드밸런서 생성 클릭</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649316-a1ee2480-d864-11eb-859c-6edff407e15d.JPG\" alt=\"2  에이엘비로드밸런서생성\"></p>\n<ul>\n<li>핵심 구성요소로 <strong><u>리스너와 대상 그룹 존재</u></strong></li>\n<li>서비스 대상 프로토콜과 포트 설정</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649318-a286bb00-d864-11eb-8611-b608d422d31a.JPG\" alt=\"2-1\"></p>\n<ul>\n<li>VPC 및 가용 영역 설정</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649321-a286bb00-d864-11eb-90b7-370c4889ea5e.JPG\" alt=\"2-2\"></p>\n<ul>\n<li>ALB는 보안 그룹을 설정해 주어야 합니다.</li>\n<li>보안 그룹은 서비스 대상을 지정하여 허용하는 필터링 기능입니다.(CloudFormation에 만든 자원을 설정)</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649323-a31f5180-d864-11eb-9093-34cd2b71ba3e.JPG\" alt=\"3  보안그룹 설정\"></p>\n<ul>\n<li>\n<p>라우팅 구성 설정</p>\n<ul>\n<li><strong><u>대상 그룹과 상태 검사 설정을 합니다.</u></strong></li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649325-a31f5180-d864-11eb-8c00-04c4ecadf089.JPG\" alt=\"4  대상그룹설정\"></p>\n<ul>\n<li>\n<p>대상 그룹 대상 설정</p>\n<ul>\n<li>ELB-EC2-1, ELB-EC2-2</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649327-a3b7e800-d864-11eb-8492-6fd30529ee2f.JPG\" alt=\"5  대상그룹 등록설정\"></p>\n<ul>\n<li>\n<p>ALB 생성 시, <strong>프로비저닝 상태</strong>로 정상적인 동작 상태가 아님</p>\n<ul>\n<li>정상 동작을 한다면 곧 <strong>active</strong>상태로 변경</li>\n</ul>\n</li>\n<li>\n<p>기다리는 동안, 대상 그룹을 확인</p>\n<ul>\n<li>경로: 서비스 - EC2 - 로드밸런싱 - 대상그룹</li>\n</ul>\n</li>\n<li>\n<p>초기 <strong>intial</strong> 상태로 상태 검사가 진행중인 상태임, 인스턴스 상태가 확인되지 않은 것을 의미</p>\n<ul>\n<li>시간이 지난 후, <strong>healthy</strong>로 상태 변경</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649331-a4507e80-d864-11eb-8bb2-066d6a76262f.JPG\" alt=\"6  대상그룹확인\"></p>\n<h3 id=\"alb-검증\" style=\"position:relative;\"><a href=\"#alb-%EA%B2%80%EC%A6%9D\" aria-label=\"alb 검증 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ALB 검증</h3>\n<ul>\n<li>ALB DNS 주소 확인</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649336-a4e91500-d864-11eb-80e3-56321f42aaff.JPG\" alt=\"7  에이엘비 검증\"></p>\n<ul>\n<li>\n<p>My-EC2 인스턴스에서 ALB 검증</p>\n<ul>\n<li>EC2-1, EC-2 인스턴스가 번갈아 가면서 접속됨</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649339-a4e91500-d864-11eb-9985-34a1598ebd0a.JPG\" alt=\"7-1\"></p>\n<blockquote>\n<p>ALB의 기본적인 로드밸런싱 알고리즘은 <strong>라운트 로빈 방식을 취하고 있음</strong></p>\n</blockquote>\n<h3 id=\"경로-기반-라우팅-기능\" style=\"position:relative;\"><a href=\"#%EA%B2%BD%EB%A1%9C-%EA%B8%B0%EB%B0%98-%EB%9D%BC%EC%9A%B0%ED%8C%85-%EA%B8%B0%EB%8A%A5\" aria-label=\"경로 기반 라우팅 기능 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>경로 기반 라우팅 기능</h3>\n<ul>\n<li>\n<p>현재 EC2-1, EC2-2 모두 <em>index.html</em> 페이지를 보유중인데,</p>\n<ul>\n<li>EC2-1에는 <em>dev/index.html</em>,</li>\n<li>EC2-2에는 <em>mgt/index.html</em> 각각 보유중임</li>\n<li>해당 경로를 같은 대상그룹으로 묶은 ALB로 시험</li>\n</ul>\n</li>\n<li>\n<p><strong>dev, mgt 각각 한번은 경로를 찾고, 한번은 경로를 찾지 못함</strong></p>\n<ul>\n<li>이러한 것을 해결하기 위한 기능이 <strong><u>경로 기반 라우팅 기능입니다.</u></strong></li>\n<li>해당 기능을 사용하기 위해 대상그룹을 분리 해야 함</li>\n<li>경로: 서비스 - EC2 - 로드밸런싱 - 대상그룹 - 대상그룹생성</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649342-a581ab80-d864-11eb-90cc-6205610b7291.JPG\" alt=\"8  경로기반라우팅설정\"></p>\n<ul>\n<li>\n<p>대상 그룹 분리 및 생성</p>\n<ul>\n<li>Dev, Mgt 모두 대상그룹을 각각 생성</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649347-a61a4200-d864-11eb-943f-0686d9cd57e1.JPG\" alt=\"8-1\"></p>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649349-a61a4200-d864-11eb-9fa0-31f1b479ff95.JPG\" alt=\"8-2\"></p>\n<ul>\n<li><strong>생성한 ALB 페이지의 리스너에서 경로 기반 라우팅을 설정</strong></li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649356-a6b2d880-d864-11eb-9f9f-be31ce87ed6a.JPG\" alt=\"8-3\"></p>\n<ul>\n<li>규칙 삽입, 조건 삽입, 경로 삽입, 대상 그룹 설정</li>\n<li>\n<p>마찮가지로 Mgt도 규칙 생성</p>\n<ul>\n<li>/dev/ 경로로 향하는 URL 주소는 Dev-Group에 속한 인스턴스로 전달하고,</li>\n<li>/mgt/ 경로로 향하는 URL 주소는 Mgt-Group에 속한 인스턴스로 전달하라는 의미임</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649358-a74b6f00-d864-11eb-8849-d0aee1bec550.JPG\" alt=\"8-4\"></p>\n<ul>\n<li>\n<p>각각 총 5번씩 테스트 진행, 모두 정상적으로 트래픽이 라우팅 되는 모습</p>\n<ul>\n<li>dev 경로는 EC2-1 으로,</li>\n<li>mgt 경로는 EC2-2 으로,</li>\n<li>index.html은 양쪽 번갈아가며 트래픽이 유입됩니다.</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649359-a74b6f00-d864-11eb-9828-85f47b572567.JPG\" alt=\"8-5\"></p>\n<h2 id=\"nlb를-통한-로드밸런싱-1\" style=\"position:relative;\"><a href=\"#nlb%EB%A5%BC-%ED%86%B5%ED%95%9C-%EB%A1%9C%EB%93%9C%EB%B0%B8%EB%9F%B0%EC%8B%B1-1\" aria-label=\"nlb를 통한 로드밸런싱 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NLB를 통한 로드밸런싱</h2>\n<h3 id=\"nlb-생성\" style=\"position:relative;\"><a href=\"#nlb-%EC%83%9D%EC%84%B1\" aria-label=\"nlb 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NLB 생성</h3>\n<ul>\n<li>경로: 서비스 - EC2 - 로드밸런싱 - 로드밸런서 - 로드밸런서 생성 클릭</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649361-a7e40580-d864-11eb-9d73-a97d997730b5.JPG\" alt=\"9  NLB 생성\"></p>\n<ul>\n<li>\n<p>NLB 이름 설정 및 인터넷 경계 설정</p>\n<ul>\n<li>이전 ALB와 설정 화면이 조금 다르다.</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649363-a87c9c00-d864-11eb-81b8-24f1b5e12b76.JPG\" alt=\"9-1  NLB 생성\"></p>\n<ul>\n<li>ELB VPC 선택 및 가용영역 / 서브넷 선택</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649366-a87c9c00-d864-11eb-9ed4-339242c5734f.JPG\" alt=\"9-2  NLB 생성\"></p>\n<ul>\n<li>\n<p>리스너 라우팅 설정</p>\n<ul>\n<li>해당 설정도 기존과 좀 다르다.</li>\n<li>대상 그룹이 사전에 만들어져 있어야 함</li>\n<li><em>Default action</em> 에서 만든 해당 그룹을 선택해야 함</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649368-a9153280-d864-11eb-8247-554cd7bdf187.JPG\" alt=\"9-3  NLB 생성\"></p>\n<ul>\n<li>\n<p>NLB 대상 그룹 생성 / (위 사진에서 Create target group를 눌러 대상그룹을 NLB 생성 중간 과정에 만들었다.)</p>\n<ul>\n<li>그룹 이름 설정</li>\n<li>포트 설정</li>\n<li>VPC 선택</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649369-a9adc900-d864-11eb-8906-c10249aead4d.JPG\" alt=\"9-4  NLB 타켓그룹설정\"></p>\n<ul>\n<li>대상 그룹 헬스체크 설정, 상태 검사 프로토콜 포트 HTTP 포트로 재정의</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649373-a9adc900-d864-11eb-9690-e8e15fcc5595.JPG\" alt=\"9-5  NLB 타켓그룹설정\"></p>\n<ul>\n<li>대상 그룹 타겟을 설정 후, 대상 그룹에 정상적인 상태를 확인한 모습</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649375-aa465f80-d864-11eb-838c-3ddf3133634e.JPG\" alt=\"9-6  엔엘비 대상그룹 확인\"></p>\n<ul>\n<li>NLB 검증을 위해 NLB의 DNS 주소 복사</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649377-aa465f80-d864-11eb-8851-daf86f233128.JPG\" alt=\"9-7  NLB 확인\"></p>\n<h3 id=\"nlb-검증\" style=\"position:relative;\"><a href=\"#nlb-%EA%B2%80%EC%A6%9D\" aria-label=\"nlb 검증 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NLB 검증</h3>\n<ul>\n<li>SNMP 서비스를 확인</li>\n<li>\n<p><code class=\"language-text\">snmpget</code> 명령어로 NLB DNS 주소로 시스템 이름(SNMP OID 1.3.6.1.2.1.1.5.0)을 요청 시, <em>ELB-EC2-1, ELB-EC2-2</em>가 번갈아 응답합니다.</p>\n<ul>\n<li><strong><u>즉, UDP 프로토콜 161 포트로 전달하는 SNMP 요청을 NLB가 부하 분산하여 대상 그룹에 속한 2개의 인스턴스로 부하 분산하는 것입니다.</u></strong></li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649383-aadef600-d864-11eb-8099-f18007f104e4.JPG\" alt=\"10  NLB 검증\"></p>\n<ul>\n<li>\n<p>추가로 사용자가 전달하는 요청에 대해 NLB 로드 밸런서를 거쳐갈 때, 출발지 IP를 어떻게 전달하는지 확인</p>\n<ul>\n<li><code class=\"language-text\">3.35.55.43 &gt; 10.0.0.57</code> 은 출발지 IP가 <code class=\"language-text\">3.35.x.x</code> 라는 것으로 해당 IP는 <em>My-EC2</em>에 해당</li>\n<li><strong><u>즉, NLB는 출발지 IP를 사용자의 퍼블릭 IP를 그대로 유지하여 전달하는 특징이 있음</u></strong></li>\n<li>반면, ALB는 출발지 IP를 사용자의 IP 주소가 아닌, ALB 자신의 로컬 IP로 통신하는 특징이 있음</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/123649385-ab778c80-d864-11eb-8947-0d9ad3e65ee0.JPG\" alt=\"11  엔엘비 로드밸런서 출발지 아이피확인\"></p>\n<h3 id=\"결론\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EB%A1%A0\" aria-label=\"결론 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결론</h3>\n<ul>\n<li>ALB는 HTTP(S)에 특화되어 상세한 제어가 가능한 로드밸런서</li>\n<li>NLB는 TCP, UDP 모든 포트에 대하여 빠른 처리 속도의 로드밸런서</li>\n<li>또한, NLB는 클라이언트 IP를 보존하지만,</li>\n<li>ALB는 클라이언트 IP를 보존하지않고, 자신의 IP로 대체하여 전달하는 차이가 있음</li>\n</ul>\n<blockquote>\n<p>클라이언트 IP를 보존하지 않으면, 서버 입장에서는 어떤 대상의 IP가 접근했는지 알 수 없습니다.</p>\n<p>이런 부분을 해결하기 위해 ALB에서는 X-Forwarded-For 헤더라는 곳에 클라이언트 IP정보를 담아 전달합니다.</p>\n</blockquote>\n<h2 id=\"자원-삭제-1\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EC%9B%90-%EC%82%AD%EC%A0%9C-1\" aria-label=\"자원 삭제 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자원 삭제</h2>\n<ul>\n<li>로드 밸런서 삭제</li>\n<li>대상 그룹 삭제</li>\n<li>CloudFormation 삭제</li>\n</ul>","frontmatter":{"title":"[AWS] ALB와 NLB를 통한 로드밸런싱","date":"June 28, 2021","category":"☁️ cloud"}}},"pageContext":{"slug":"/cloud/[AWS] ALB와 NLB를 통한 로드밸런싱/","previous":{"fields":{"slug":"/cloud/[AWS] ELB(부하 분산)/"},"frontmatter":{"title":"[AWS] ELB(부하 분산)","category":"☁️ cloud","draft":false}},"next":{"fields":{"slug":"/cloud/[AWS] 가비아 도메인 구입 후 AWS-Route53 연결하기/"},"frontmatter":{"title":"[AWS] 가비아 도메인 구입 후 AWS-Route53 연결하기","category":"☁️ cloud","draft":false}}}},"staticQueryHashes":["3128451518","521680639"]}