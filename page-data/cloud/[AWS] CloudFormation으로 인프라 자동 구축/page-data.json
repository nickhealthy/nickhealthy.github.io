{"componentChunkName":"component---src-templates-blog-post-js","path":"/cloud/[AWS] CloudFormation으로 인프라 자동 구축/","result":{"data":{"site":{"siteMetadata":{"title":"Woo's Dev Log","author":"nickhealthy","siteUrl":"https://nickhealthy.github.io","comment":{"disqusShortName":"","utterances":"nickhealthy/nickhealthy.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"474e644c-f027-5652-bbb4-5ee368dfbdb7","excerpt":"CloudFormation 이란 AWS 인프라에 대해 코드로 개략적인 선언을 하는 방법 AWS 인프라 자원을 코드로 정의하여 자동으로 정의된 자원을 생성하거나 삭제할 수 있습니다.(IaC - Infrastructure as Code) CloudFormation 스택을 생성하여 인프라를 자동으로 생성하고, CloudFormation 스택을 삭제하여 생성된 인프라를 자동으로 삭제하는 실습 YAML 파일 생성 템플릿 Json이나 YAML…","html":"<div class=\"quote-block\">\n<div class=\"quote-block__emoji\">💡</div>\n<div class=\"quote-block__content\" markdown=1>\n<p>CloudFormation 이란</p>\n<ul>\n<li>AWS 인프라에 대해 코드로 개략적인 선언을 하는 방법</li>\n<li>AWS 인프라 자원을 코드로 정의하여 자동으로 정의된 자원을 생성하거나 삭제할 수 있습니다.(IaC - Infrastructure as Code)</li>\n</ul>\n</div>\n</div>\n<hr>\n<p>CloudFormation 스택을 생성하여 인프라를 자동으로 생성하고,<br>\nCloudFormation 스택을 삭제하여 생성된 인프라를 자동으로 삭제하는 실습</p>\n<h2 id=\"yaml-파일-생성\" style=\"position:relative;\"><a href=\"#yaml-%ED%8C%8C%EC%9D%BC-%EC%83%9D%EC%84%B1\" aria-label=\"yaml 파일 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>YAML 파일 생성</h2>\n<h3 id=\"템플릿\" style=\"position:relative;\"><a href=\"#%ED%85%9C%ED%94%8C%EB%A6%BF\" aria-label=\"템플릿 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>템플릿</h3>\n<ul>\n<li>Json이나 YAML 파일 형식의 코드로 작성할 수 있습니다.</li>\n</ul>\n<h3 id=\"스택-생성\" style=\"position:relative;\"><a href=\"#%EC%8A%A4%ED%83%9D-%EC%83%9D%EC%84%B1\" aria-label=\"스택 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>스택 생성</h3>\n<ul>\n<li>템플릿을 CLoudFormation에 업로드하여 스택을 생성할 수 있습니다.</li>\n<li>템플릿에 정의된 AWS 인프라 자원에 대해 순서대로 자동 생성합니다.</li>\n</ul>\n<h3 id=\"스택-삭제\" style=\"position:relative;\"><a href=\"#%EC%8A%A4%ED%83%9D-%EC%82%AD%EC%A0%9C\" aria-label=\"스택 삭제 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>스택 삭제</h3>\n<ul>\n<li>스택 생성에 의해 생성된 AWS 인프라 자원을 순서대로 자동 삭제합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">Parameters</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">KeyName</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Description</span><span class=\"token punctuation\">:</span> Name of an existing EC2 KeyPair to enable SSH access to the instances. Linked to AWS Parameter\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>KeyPair<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>KeyName\n    <span class=\"token key atrule\">ConstraintDescription</span><span class=\"token punctuation\">:</span> must be the name of an existing EC2 KeyPair.\n  <span class=\"token key atrule\">LatestAmiId</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Description</span><span class=\"token punctuation\">:</span> (DO NOT CHANGE)\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'AWS::SSM::Parameter::Value&lt;AWS::EC2::Image::Id>'</span>\n    <span class=\"token key atrule\">Default</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'/aws/service/ami-amazon-linux-latest/amzn2-ami-hvm-x86_64-gp2'</span>\n    <span class=\"token key atrule\">AllowedValues</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> /aws/service/ami<span class=\"token punctuation\">-</span>amazon<span class=\"token punctuation\">-</span>linux<span class=\"token punctuation\">-</span>latest/amzn2<span class=\"token punctuation\">-</span>ami<span class=\"token punctuation\">-</span>hvm<span class=\"token punctuation\">-</span>x86_64<span class=\"token punctuation\">-</span>gp2\n\n<span class=\"token key atrule\">Resources</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">MyInstance</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>Instance\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">ImageId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> LatestAmiId\n      <span class=\"token key atrule\">InstanceType</span><span class=\"token punctuation\">:</span> t2.micro\n      <span class=\"token key atrule\">KeyName</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> KeyName\n      <span class=\"token key atrule\">Tags</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Name\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> WebServer\n      <span class=\"token key atrule\">SecurityGroups</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token tag\">!Ref</span> MySG\n      <span class=\"token key atrule\">UserData</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">Fn::Base64</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Sub</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n          #!/bin/bash\n          yum install httpd -y\n          systemctl start httpd &amp;&amp; systemctl enable httpd\n          echo \"&lt;h1>Test Web Server&lt;/h1>\" > /var/www/html/index.html</span>\n\n  <span class=\"token key atrule\">MySG</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EC2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>SecurityGroup\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">GroupDescription</span><span class=\"token punctuation\">:</span> Enable HTTP access via port 80 and SSH access via port 22\n      <span class=\"token key atrule\">SecurityGroupIngress</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">IpProtocol</span><span class=\"token punctuation\">:</span> tcp\n          <span class=\"token key atrule\">FromPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n          <span class=\"token key atrule\">ToPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n          <span class=\"token key atrule\">CidrIp</span><span class=\"token punctuation\">:</span> 0.0.0.0/0\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">IpProtocol</span><span class=\"token punctuation\">:</span> tcp\n          <span class=\"token key atrule\">FromPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">22</span>\n          <span class=\"token key atrule\">ToPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">22</span>\n          <span class=\"token key atrule\">CidrIp</span><span class=\"token punctuation\">:</span> 0.0.0.0/0</code></pre></div>\n<h2 id=\"템플릿을-이용해-cloudformation-스택-생성--확인\" style=\"position:relative;\"><a href=\"#%ED%85%9C%ED%94%8C%EB%A6%BF%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%B4-cloudformation-%EC%8A%A4%ED%83%9D-%EC%83%9D%EC%84%B1--%ED%99%95%EC%9D%B8\" aria-label=\"템플릿을 이용해 cloudformation 스택 생성  확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>템플릿을 이용해 CloudFormation 스택 생성 &#x26; 확인</h2>\n<ol>\n<li>콘솔 서비스 - CloudFormation - 스택생성 클릭</li>\n<li>\n<p>YAML 파일을 업로드 해 스택생성</p>\n<ul>\n<li>준비된 템플릿 - 템플릿 파일 업로드 - 파일선택(JSON 또는 YAML 파일로 작성된 코드 업로드)</li>\n</ul>\n</li>\n</ol>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/120592246-7d2aab00-c478-11eb-8dc5-8ced3473d46c.JPG\" alt=\"1-1 스택생성\"></p>\n<ol start=\"3\">\n<li>스택이름 설정 &#x26; 키페어 설정</li>\n</ol>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/120592250-7e5bd800-c478-11eb-9c96-96802b1f24eb.JPG\" alt=\"1-2키페어선택\"></p>\n<ol start=\"4\">\n<li>시간이 지나고 자동으로 스택이 생성되고 있는 모습</li>\n</ol>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/120592251-7e5bd800-c478-11eb-9da7-342f253b2513.JPG\" alt=\"1-3스택생성완료\"></p>\n<ol start=\"5\">\n<li>EC2 생성 완료 및 SSH를 이용해 진입</li>\n</ol>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/120592254-7ef46e80-c478-11eb-96b0-6e40bb1cd7b1.JPG\" alt=\"1-4인스턴스실행중\"></p>\n<ol start=\"6\">\n<li>YAML파일에 작성한 코드가 자동으로 실행되어진 모습(웹 서버)</li>\n</ol>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/120592256-7f8d0500-c478-11eb-9f05-2da2d4558bd9.JPG\" alt=\"1-5자동으로 실행된 모습\"></p>\n<h2 id=\"cloudformation-삭제\" style=\"position:relative;\"><a href=\"#cloudformation-%EC%82%AD%EC%A0%9C\" aria-label=\"cloudformation 삭제 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CloudFormation 삭제</h2>\n<p>CloudFormation을 삭제하면 자원을 일일이 삭제할 필요 없이 <strong>생성된 자원 순서대로 삭제된다.</strong></p>\n<ul>\n<li>서비스 - CloudFormation - 스택 - 생성한 스택 선택 - 삭제 - 스택삭제</li>\n</ul>","frontmatter":{"title":"[AWS] CloudFormation으로 인프라 자동 구축(EC2 웹서버)","date":"June 01, 2021","category":"☁️ cloud"}}},"pageContext":{"slug":"/cloud/[AWS] CloudFormation으로 인프라 자동 구축/","previous":{"fields":{"slug":"/cloud/[AWS] 서비스와 클라우드/"},"frontmatter":{"title":"[AWS] 서비스와 클라우드","category":"☁️ cloud","draft":false}},"next":{"fields":{"slug":"/cloud/[AWS] VPC 서비스 및 기본개념/"},"frontmatter":{"title":"[AWS] VPC 서비스 및 기본개념","category":"☁️ cloud","draft":false}}}},"staticQueryHashes":["3128451518","521680639"]}