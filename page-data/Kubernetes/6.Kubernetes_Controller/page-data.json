{"componentChunkName":"component---src-templates-blog-post-js","path":"/Kubernetes/6.Kubernetes_Controller/","result":{"data":{"site":{"siteMetadata":{"title":"Woo's Dev Log","author":"nickhealthy","siteUrl":"https://nickhealthy.github.io","comment":{"disqusShortName":"","utterances":"nickhealthy/nickhealthy.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"e5b5aed1-28c5-52d6-88a7-1b5955b0ef72","excerpt":"Controller Controller의 주 역할은 Pod 을 생성, 관리하는 것이다. Controller의 역할 :  또는 의 문제로 인해 Pod가 다운될 시 Pod…","html":"<h1 id=\"controller\" style=\"position:relative;\"><a href=\"#controller\" aria-label=\"controller permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Controller</h1>\n<blockquote>\n<p>Controller의 주 역할은 <strong>Pod 을 생성, 관리하는 것이다.</strong></p>\n</blockquote>\n<h3 id=\"controller의-역할\" style=\"position:relative;\"><a href=\"#controller%EC%9D%98-%EC%97%AD%ED%95%A0\" aria-label=\"controller의 역할 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Controller의 역할</h3>\n<ul>\n<li><code class=\"language-text\">Auto Healing</code>: <code class=\"language-text\">Pod</code> 또는 <code class=\"language-text\">Node</code>의 문제로 인해 Pod가 다운될 시 Pod를 정상적으로 동작하도록 <strong>재생성해준다.</strong></li>\n<li><code class=\"language-text\">Auto Scaling</code>: <code class=\"language-text\">Pod</code>의 자원 상태가 <code class=\"language-text\">limit</code>의 상태로 돌입하였을 때 이를 감지하여 <strong><code class=\"language-text\">Pod</code>를 하나 더 생성해 부하를 분산시켜 성능에 대한 장애 없이 안정적인 서비스를 운영할 수 있게 해준다.</strong></li>\n<li>\n<p><code class=\"language-text\">Software Update</code>: 여러 <code class=\"language-text\">Pod</code>에 대한 버전 업그레이드를 컨트롤러를 통해 쉽게 업그레이드가 가능하다.</p>\n<ul>\n<li>업그레이드 도중에 기능문제가 생길 시 <strong>롤백 기능이 있음</strong></li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">Job</code>: 필요한(일시적인) 순간에만 작업을 해야할 때만 해당 작업 이행 후 제거할 수 있다.</p>\n<ul>\n<li><strong>필요한 순간에만 자원이 생성되고 삭제되기 때문에 효율적인 자원 활용이 가능함</strong></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"replication-controller---deprecated사용되지-않음\" style=\"position:relative;\"><a href=\"#replication-controller---deprecated%EC%82%AC%EC%9A%A9%EB%90%98%EC%A7%80-%EC%95%8A%EC%9D%8C\" aria-label=\"replication controller   deprecated사용되지 않음 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Replication Controller - Deprecated(사용되지 않음)</h1>\n<blockquote>\n<p>현재 <code class=\"language-text\">Replication Controller</code> 대체용으로 <code class=\"language-text\">ReplicaSet</code>이 사용되고 있다.<br>\n지정된 숫자로 Pod을 기동 시키고 관리한다.</p>\n</blockquote>\n<h3 id=\"기능\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%EB%8A%A5\" aria-label=\"기능 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>기능</h3>\n<ul>\n<li>\n<p><code class=\"language-text\">template</code>: <code class=\"language-text\">Pod</code>를 재생성 또는 추가로 기동시킬 때 즉, <code class=\"language-text\">template</code>에 정의된 내용을 토대로 Pod를 생성</p>\n<ul>\n<li>Pod를 미리 생성해놓고 연결할 수도 있고 미리 생성하지 않고도 연결해줄 수 있다.</li>\n</ul>\n</li>\n<li><code class=\"language-text\">replicas</code>: 정해진 개수만큼 <code class=\"language-text\">Pod</code>의 스케일 인/아웃을 관리해준다.</li>\n</ul>\n<h1 id=\"replicaset\" style=\"position:relative;\"><a href=\"#replicaset\" aria-label=\"replicaset permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ReplicaSet</h1>\n<blockquote>\n<p>지정된 숫자로 Pod을 기동 시키고 관리한다.</p>\n</blockquote>\n<h3 id=\"기능-1\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%EB%8A%A5-1\" aria-label=\"기능 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>기능</h3>\n<ul>\n<li><code class=\"language-text\">template</code>, <code class=\"language-text\">replicas</code> 두개의 기능을 기본적으로 가지고 있다.</li>\n<li><code class=\"language-text\">selector</code>: <code class=\"language-text\">label</code> 기준으로 어떤 Pod들을 관리할지 정의한다.</li>\n</ul>\n<h3 id=\"selector의-속성\" style=\"position:relative;\"><a href=\"#selector%EC%9D%98-%EC%86%8D%EC%84%B1\" aria-label=\"selector의 속성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Selector의 속성</h3>\n<ul>\n<li>\n<p><code class=\"language-text\">matchLabels</code> : 기존의 <code class=\"language-text\">label</code> 기능과 같이 Key: value의 값이 <code class=\"language-text\">Pod - label</code>과 동일한 Pod들만 연결 시켜주는 기능</p>\n<blockquote>\n<p>주의사항: <code class=\"language-text\">label</code>에 정의된 내용을 기준으로 작성해야 한다.</p>\n</blockquote>\n</li>\n<li>\n<p><code class=\"language-text\">matchExpressions</code>: 조건을 걸어 <code class=\"language-text\">label</code>을 좀 더 정교하게 필터링하는 기능</p>\n<ul>\n<li>Exists: value 값에 상관없이 <code class=\"language-text\">key</code> 값이 <code class=\"language-text\">Pod</code>에 존재하는 것만 연결시켜주는 기능</li>\n<li>DoesNotExist: value 값에 상관없이 <code class=\"language-text\">key</code> 값이 <code class=\"language-text\">Pod</code>에 존재하지 않는 것만 연결시켜주는 기능</li>\n<li>In: 해당 <code class=\"language-text\">key</code>를 포함하는 <code class=\"language-text\">Pod</code>들 중에서 <code class=\"language-text\">value</code>의 값들이 존재하는 것만 연결시켜주는 기능</li>\n<li>NotIn: 해당 <code class=\"language-text\">key</code>를 포함하는 <code class=\"language-text\">Pod</code>들 중에서 <code class=\"language-text\">value</code>의 값들이 존재하지 않는 것만 연결시켜주는 기능</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"tips\" style=\"position:relative;\"><a href=\"#tips\" aria-label=\"tips permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tips</h3>\n<ul>\n<li>ReplicaSet에서 만들어진 여러 개의 Pod들은 각각의 Pod를 구별해 주기 위해 Pod이름 앞에 <strong>자동으로 레플리카셋의 이름을 포함하여 만들어 진다.</strong></li>\n<li>\n<p>레플리카 오브젝트를 지우게 되면 자동으로 안에 있던 <code class=\"language-text\">Pod</code>들도 삭제가 된다. 하지만 레플리카 오브젝트를 지울 때 <code class=\"language-text\">Pod</code>를 살릴 수 있는 옵션이 있는데 바로 <code class=\"language-text\">--cascade==false</code> 라는 옵션이다.</p>\n<ul>\n<li>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ kubectl delete 레플리카_오브젝트명 레플리카_네임 --cascade<span class=\"token operator\">==</span>false</code></pre></div>\n</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"deployment\" style=\"position:relative;\"><a href=\"#deployment\" aria-label=\"deployment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deployment</h1>\n<blockquote>\n<p>서비스를 업데이트해서 배포 및 재배포 시 도움을 주는 컨트롤러<br>\nReplicationController 와 ReplicaSet 을 좀더 추상화한 개념</p>\n</blockquote>\n<h3 id=\"쿠버네티스의-일반적인-배포-및-업그레이드-방식\" style=\"position:relative;\"><a href=\"#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%EC%9D%98-%EC%9D%BC%EB%B0%98%EC%A0%81%EC%9D%B8-%EB%B0%B0%ED%8F%AC-%EB%B0%8F-%EC%97%85%EA%B7%B8%EB%A0%88%EC%9D%B4%EB%93%9C-%EB%B0%A9%EC%8B%9D\" aria-label=\"쿠버네티스의 일반적인 배포 및 업그레이드 방식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>쿠버네티스의 일반적인 배포 및 업그레이드 방식</h3>\n<h4 id=\"recreate\" style=\"position:relative;\"><a href=\"#recreate\" aria-label=\"recreate permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ReCreate</h4>\n<ul>\n<li>\n<p>이전 <code class=\"language-text\">Pod</code>들을 삭제 후 새 버전의 <code class=\"language-text\">Pod</code>를 재배포</p>\n<ul>\n<li>서비스에 대한 다운타임이 발생 (일시적인 서비스 중지가 가능할때만 사용가능)</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/105191756-ca1d7d00-5b7a-11eb-9915-3868ebdbd437.PNG\" alt=\"1\"></p>\n<blockquote>\n<p>(옵션) revisionHistoryLimit: 이전 버전의 히스토리 보관 개수를 지정한다.</p>\n</blockquote>\n<br />\n<h4 id=\"rolling-updatedefault\" style=\"position:relative;\"><a href=\"#rolling-updatedefault\" aria-label=\"rolling updatedefault permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Rolling Update(default)</h4>\n<ul>\n<li>\n<p>새 버전을 먼저 만들어준다. 즉, V1, V2 버전이 동시에 서비스가 되고 있기 때문에 사용자의 버전이 다를 수 있다.</p>\n<ul>\n<li>또한 자원 사용량이 증가된다.(V1, V2 버전이 동시에 운용)</li>\n<li>이후 이전 버전의 Pod를 차례로 삭제해준다.</li>\n</ul>\n</li>\n<li>추가적인 자원을 요구하지만, 다운타임이 없다.</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/105191793-d570a880-5b7a-11eb-83f7-a6a675db6a53.PNG\" alt=\"2\"></p>\n<blockquote>\n<p>(옵션) minReadySeconds : V1 -> V2 로 버전을 업데이트할 때 대기 시간을 부여한다.</p>\n</blockquote>\n<br />\n<h4 id=\"bluegreen\" style=\"position:relative;\"><a href=\"#bluegreen\" aria-label=\"bluegreen permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Blue/Green</h4>\n<blockquote>\n<p><strong>블루그린은 새버전, 구버전의 2세트의 서버를 마련하고 한꺼번에 교체하는 배포 방법이다.</strong><br>\n로드 밸런서 혹은 서비스 디스커버리 수준에서 참조 대상을 교체하는 방식으로 이뤄지는 배포형태이다.</p>\n<ul>\n<li>두개의 ReplicaSet.yml 를 작성이 선행되어야 한다.</li>\n</ul>\n</blockquote>\n<ul>\n<li>\n<p>Service 컨트롤러를 이용해 <code class=\"language-text\">label</code> 단위로 V1, V2 버전을 선택. 즉, 신버전, 구버전의 순간적인 교체 가능</p>\n<ul>\n<li>문제 시 <code class=\"language-text\">label</code>만 이전 버전(V1)으로 바꿔주는 롤백이 가능(스탠바이 상태 가능), 다운 타임이 없음</li>\n<li>단점은 배포할 서버군을 2게통으로 유지해야 하므로 롤링 업데이트보다 필요 리소스 양이 늘어난다</li>\n</ul>\n</li>\n</ul>\n<br />\n<h4 id=\"canary\" style=\"position:relative;\"><a href=\"#canary\" aria-label=\"canary permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Canary</h4>\n<blockquote>\n<p>신규 버전을 배포할 때 한꺼번에 앱의 전체를 교체하는게 아니라 <strong>기존 버전을 유지한 채로 일부 버전만 신규 버전으로 올려서 신규 버전에 버그나 이상은 없는지를 사용자 반응은 어떤지 확인</strong>하는데 유용하게 사용하는 방법이다.</p>\n</blockquote>\n<ul>\n<li>\n<p><code class=\"language-text\">Pod</code>에 대한 <code class=\"language-text\">label</code>을 2개 달아놓고, 레플리카셋 등으로 테스트용 <code class=\"language-text\">Canary-Pod</code>의 개수를 할당해 트래픽을 분산 및 신규 버전을 테스트하는 식이다.</p>\n<ul>\n<li>다운 타임이 존재하지 않다. 하지만 파드나 서비스 배포 개수에 따라 자원이 그만큼 더 필요하다.</li>\n</ul>\n</li>\n</ul>\n<h5 id=\"ingress-controller\" style=\"position:relative;\"><a href=\"#ingress-controller\" aria-label=\"ingress controller permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ingress Controller</h5>\n<ul>\n<li>이 옵션을 이용하면 <code class=\"language-text\">Path</code>를 이용해 특정 target을 대상으로 테스트가 가능하다.</li>\n</ul>\n<br />\n<h1 id=\"daemonset\" style=\"position:relative;\"><a href=\"#daemonset\" aria-label=\"daemonset permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DaemonSet</h1>\n<blockquote>\n<p>이전까진 ReplicaSet과 같은 컨트롤러와 쿠버네티스 스케줄러에 의해 각 Node의 자원량을 점수로 환산해 적절한 곳에 <code class=\"language-text\">Pod</code>를 배치 시켰지만, <strong><code class=\"language-text\">Daemonset</code>은 각 <code class=\"language-text\">Node</code>에 <code class=\"language-text\">Pod</code>를 하나씩 생성해 준다.</strong></p>\n<ul>\n<li>각 노드에 두개 이상의 Pod를 만들 순 없지만 <code class=\"language-text\">nodeSelector-label</code> 를 통해 특정 노드에 Pod를 안만들 순 있다.</li>\n</ul>\n</blockquote>\n<h3 id=\"대표적인-사용사례\" style=\"position:relative;\"><a href=\"#%EB%8C%80%ED%91%9C%EC%A0%81%EC%9D%B8-%EC%82%AC%EC%9A%A9%EC%82%AC%EB%A1%80\" aria-label=\"대표적인 사용사례 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>대표적인 사용사례</h3>\n<ul>\n<li>\n<p>성능 수집</p>\n<ul>\n<li>각 노드들의 성능을 체크할 수 있는 모니터링 서비스가 필요하다.(<code class=\"language-text\">Prometheus</code> 툴 등)</li>\n</ul>\n</li>\n<li>\n<p>로그 수집</p>\n<ul>\n<li>특정 노드에 장애가 발생했을 경우 문제를 파악하기 위해 필요하다. (<code class=\"language-text\">fluentd</code> 툴 등)</li>\n</ul>\n</li>\n<li>\n<p>각 노드에 대한 정보를 저장 - Storage</p>\n<ul>\n<li>각각의 노드에서 네트워크 파일 시스템을 구축할 수 있다. (<code class=\"language-text\">GlusterFS</code> 툴 등)</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/105191826-df92a700-5b7a-11eb-8ca5-04e39ae93479.PNG\" alt=\"3\"></p>\n<blockquote>\n<p>(옵션) hostPort: Service의 <code class=\"language-text\">externalTrafficPolicy: Local</code> 처럼 해당 노드의 <code class=\"language-text\">Pod</code>에 접근이 가능하게 해준다.(같은 기능이라고 생각하면 된다.)</p>\n</blockquote>\n<br />\n<h1 id=\"job-cronjob\" style=\"position:relative;\"><a href=\"#job-cronjob\" aria-label=\"job cronjob permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Job, CronJob</h1>\n<blockquote>\n<p><code class=\"language-text\">Job</code></p>\n<ul>\n<li>한번 실행되고 끝나는 Pod 을 관리한다.</li>\n<li>Job 컨트롤러가 종료되면 Pod 도 같이 종료한다.</li>\n<li>컨테이너에서 Job 을 수행하기 위한 별도의 <code class=\"language-text\">command</code> 를 준다.</li>\n<li>Job <code class=\"language-text\">command</code> 의 성공 여부를 받아 재실행 또는 종료여부를 결정한다.</li>\n</ul>\n<p><code class=\"language-text\">CronJob</code></p>\n<ul>\n<li>Job 컨트롤러를 주기적으로 수행해야 할 때 사용한다. (Pod 등)</li>\n<li>별도의 <code class=\"language-text\">schedule</code> 을 정의해아 한다.</li>\n<li>예시: 주기적인(데이터 백업, 업데이트 확인, 예약 메일, SNS 등 메시징 관리)</li>\n</ul>\n</blockquote>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/105191858-e6b9b500-5b7a-11eb-9a6a-5490ae657229.PNG\" alt=\"4\"></p>\n<blockquote>\n<p>(옵션) completions: 정의된 개수만큼 <code class=\"language-text\">Pod</code> 정해진 작업을 수행한다.</p>\n<p>(옵션) parallelism: 정의된 개수만큼 <code class=\"language-text\">Pod</code>를 생성한다.</p>\n<p>(옵션) activeDeadlineSeconds: 정의된 시간(초)동안 동작하다 <code class=\"language-text\">Pod</code>의 수행여부와 관계없이 종료</p>\n<ul>\n<li>예를 들어 10초면 끝나야 할 작업이 30초가 되어도 끝나지 않을 시 등 점검해보기 위해 많이 사용</li>\n</ul>\n</blockquote>\n<br />\n<p><img src=\"https://user-images.githubusercontent.com/66216102/105191899-f0431d00-5b7a-11eb-9cc6-49b128e85f91.PNG\" alt=\"5\"></p>\n<blockquote>\n<p>schedule : 리눅스에서 사용하는 Cron 포맷형태 (정의된 시간대로 Job를 만든다.)</p>\n<p>concurrencyPolicy: <code class=\"language-text\">Job</code>의 동작 방식을 설정 (Allow가 default)</p>\n</blockquote>\n<p><img src=\"https://user-images.githubusercontent.com/66216102/105191906-f1744a00-5b7a-11eb-8269-b94b672f8166.PNG\" alt=\"6\"></p>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<p><a href=\"https://arisu1000.tistory.com/27842v\">https://arisu1000.tistory.com/27842</a></p>\n<p><a href=\"https://kkimsangheon.github.io/2019/06/15/kube17/\">https://kkimsangheon.github.io/2019/06/15/kube17/</a></p>\n<p><a href=\"https://dailyheumsi.tistory.com/208\">https://dailyheumsi.tistory.com/208</a></p>\n<br />\n<a href='#'><small class='up-button'>위로 올라가기💨</small></a>\n<br />","frontmatter":{"title":"#6 Kubernetes Controller(ReplicaSet, Deployment, DeamonSet, Job, CronJob)","date":"January 18, 2021","category":"🧭 Kubernetes"}}},"pageContext":{"slug":"/Kubernetes/6.Kubernetes_Controller/","previous":{"fields":{"slug":"/solving-algo/[programmers]_디스크컨트롤러/"},"frontmatter":{"title":"[programmers]디스크 컨트롤러","category":"💯 solving-algo","draft":false}},"next":{"fields":{"slug":"/solving-algo/백준_단계별_기본수학1/"},"frontmatter":{"title":"[백준]단계별풀이_기본수학1","category":"💯 solving-algo","draft":false}}}},"staticQueryHashes":["3128451518","521680639"]}